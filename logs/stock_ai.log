2025-08-05 22:14:17,669 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 22:14:20,128 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 22:14:20,130 - src.data.collector - INFO - Returning cached data for AAPL
2025-08-05 22:14:31,255 - src.data.collector - INFO - Fetching fresh data for TSLA
2025-08-05 22:14:32,492 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-05 22:14:42,834 - src.data.collector - INFO - Fetching fresh data for GOOGL
2025-08-05 22:14:44,032 - src.data.collector - INFO - Successfully fetched data for GOOGL
2025-08-05 22:33:39,368 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 22:33:39,368 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 22:33:40,290 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 22:33:40,456 - src.models.lstm_predictor - INFO - Model architecture: 60 time steps, 13 features
2025-08-05 22:33:42,912 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:43,451 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:43,709 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:43,970 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:44,229 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:44,485 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:44,740 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:44,996 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:45,253 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-05 22:33:49,451 - src.models.lstm_predictor - INFO - Enhanced training completed for AAPL in 10.1s
2025-08-05 22:33:49,451 - src.models.lstm_predictor - INFO - Final validation RMSE: 17.4536
2025-08-05 22:33:49,452 - src.models.lstm_predictor - INFO - Model R² score: -14.4315
2025-08-05 22:34:11,135 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-08-05 22:34:11,142 - src.models.lstm_predictor - INFO - Loaded enhanced model for AAPL
2025-08-05 22:34:11,142 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 22:34:11,881 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 22:34:38,315 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-08-05 22:34:38,323 - src.models.lstm_predictor - INFO - Loaded enhanced model for AAPL
2025-08-05 22:34:38,323 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 22:34:39,137 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 22:35:22,567 - absl - WARNING - Compiled the loaded model, but the compiled metrics have yet to be built. `model.compile_metrics` will be empty until you train or evaluate the model.
2025-08-05 22:35:22,575 - src.models.lstm_predictor - INFO - Loaded enhanced model for AAPL
2025-08-05 22:44:05,080 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 22:44:05,082 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL_enhanced_lstm.h5
2025-08-05 22:44:05,082 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL_scaler.pkl
2025-08-05 22:44:05,084 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL_feature_scaler.pkl
2025-08-05 22:44:05,093 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL_metrics.json
2025-08-05 22:44:05,093 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 22:44:05,855 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 22:44:05,875 - src.models.lstm_predictor - INFO - Data splits - Train: 483, Val: 103, Test: 105
2025-08-05 22:44:05,988 - src.models.lstm_predictor - INFO - Model architecture: 60 time steps, 13 features
2025-08-05 22:45:05,466 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-5.678) below minimum threshold (0.3)
2025-08-05 22:45:05,466 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 22:45:56,183 - src.models.lstm_predictor - WARNING - No saved enhanced model found for AAPL
2025-08-05 22:46:10,811 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 22:46:10,811 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 22:46:11,578 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 22:46:11,590 - src.models.lstm_predictor - INFO - Data splits - Train: 836, Val: 179, Test: 180
2025-08-05 22:46:11,692 - src.models.lstm_predictor - INFO - Model architecture: 60 time steps, 13 features
2025-08-05 22:47:32,480 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.264) below minimum threshold (0.3)
2025-08-05 22:47:32,480 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 22:49:04,931 - src.models.lstm_predictor - INFO - Starting enhanced training for SO
2025-08-05 22:49:04,931 - src.data.collector - INFO - Fetching fresh data for SO
2025-08-05 22:49:05,902 - src.data.collector - INFO - Successfully fetched data for SO
2025-08-05 22:49:05,918 - src.models.lstm_predictor - INFO - Data splits - Train: 836, Val: 179, Test: 180
2025-08-05 22:49:06,028 - src.models.lstm_predictor - INFO - Model architecture: 60 time steps, 13 features
2025-08-05 22:50:31,220 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-1.148) below minimum threshold (0.3)
2025-08-05 22:50:31,220 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 22:53:45,929 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 22:53:45,930 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 22:53:46,777 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 22:53:46,811 - src.models.lstm_predictor - INFO - Using 31 features for training: ['Close_SMA5_Ratio', 'Close_SMA10_Ratio', 'Close_SMA20_Ratio', 'Close_SMA50_Ratio', 'High_Low_Ratio', 'Close_Open_Ratio', 'High_Close_Ratio', 'Low_Close_Ratio', 'Volume_Ratio_10d', 'Volume_Ratio_20d', 'Volume_Change', 'Returns', 'Returns_2d', 'Returns_5d', 'Returns_10d', 'Momentum_5d', 'Momentum_10d', 'Rate_of_Change_5d', 'Rate_of_Change_10d', 'RSI_Normalized', 'BB_Position', 'BB_Width', 'MACD_Price_Ratio', 'MACD_Signal_Price_Ratio', 'Volatility_5d', 'Volatility_10d', 'Volatility_20d', 'Distance_SMA20', 'Distance_SMA50', 'SMA5_SMA20_Ratio', 'EMA12_EMA26_Ratio']
2025-08-05 22:53:46,827 - src.models.lstm_predictor - INFO - Prepared training data: (1195, 60, 31) features, (1195,) targets
2025-08-05 22:53:46,828 - src.models.lstm_predictor - INFO - Data splits - Train: 836, Val: 179, Test: 180
2025-08-05 22:53:46,923 - src.models.lstm_predictor - INFO - Model architecture: 60 time steps, 31 features
2025-08-05 22:55:23,226 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.009) below minimum threshold (0.1)
2025-08-05 22:55:23,227 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:01:24,143 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:01:24,143 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:01:24,950 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:01:24,986 - src.models.lstm_predictor - INFO - Using 13 features for training: ['Close_SMA5_Ratio', 'Close_SMA10_Ratio', 'Close_SMA20_Ratio', 'High_Low_Ratio', 'Close_Open_Ratio', 'Volume_Ratio_10d', 'Returns', 'Returns_2d', 'Returns_5d', 'RSI_Normalized', 'BB_Position', 'Volatility_5d', 'Volatility_10d']
2025-08-05 23:01:24,993 - src.models.lstm_predictor - INFO - Prepared training data: (1225, 30, 13) features, (1225,) targets
2025-08-05 23:01:24,993 - src.models.lstm_predictor - INFO - Data splits - Train: 857, Val: 183, Test: 185
2025-08-05 23:01:25,094 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 13 features
2025-08-05 23:02:20,554 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.010) below minimum threshold (0.1)
2025-08-05 23:02:20,555 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:04:19,804 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:04:19,804 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:04:20,611 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:04:20,643 - src.models.lstm_predictor - INFO - Using 6 features for training: ['Close_SMA5_Ratio', 'Close_SMA10_Ratio', 'High_Low_Ratio', 'Volume_Ratio_10d', 'Returns', 'Volatility_5d']
2025-08-05 23:04:20,647 - src.models.lstm_predictor - INFO - Prepared training data: (1235, 20, 6) features, (1235,) targets
2025-08-05 23:04:20,647 - src.models.lstm_predictor - INFO - Data splits - Train: 864, Val: 185, Test: 186
2025-08-05 23:04:20,747 - src.models.lstm_predictor - INFO - Model architecture: 20 time steps, 6 features
2025-08-05 23:05:07,082 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.008) below minimum threshold (0.1)
2025-08-05 23:05:07,083 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:08:57,132 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:08:57,133 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:08:57,994 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:08:58,231 - src.models.lstm_predictor - INFO - Generated 67 advanced features from 1255 data points
2025-08-05 23:08:58,232 - src.models.lstm_predictor - INFO - Using 41 features for training: ['Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'Price_SMA50_Ratio', 'SMA5_SMA20_Ratio', 'EMA12_EMA26_Ratio', 'Log_Return_1d', 'Log_Return_5d', 'Log_Return_10d', 'ROC_5', 'ROC_10', 'ROC_20', 'Volatility_5d', 'Volatility_10d', 'Volatility_20d', 'Vol_of_Vol', 'GK_Volatility', 'Volume_Ratio', 'Volume_ROC', 'Money_Flow_Ratio', 'OBV_Signal', 'RSI_Normalized', 'RSI_Smooth', 'MACD_Normalized', 'MACD_Histogram', 'BB_Position', 'BB_Width', 'Williams_R', 'Stoch_K', 'Stoch_D', 'Hurst_10d', 'Fractal_Dim', 'Efficiency_Ratio', 'Z_Score_20', 'Z_Score_50', 'High_Low_Ratio', 'Close_Open_Ratio', 'Body_Size', 'Upper_Shadow', 'Lower_Shadow', 'Trend_Strength', 'Market_Regime']
2025-08-05 23:08:58,242 - src.models.lstm_predictor - INFO - Prepared training data: (1215, 40, 41) features, (1215,) targets
2025-08-05 23:08:58,242 - src.models.lstm_predictor - INFO - Data splits - Train: 850, Val: 182, Test: 183
2025-08-05 23:08:58,344 - src.models.lstm_predictor - INFO - Model architecture: 40 time steps, 41 features
2025-08-05 23:10:34,092 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.022) below minimum threshold (0.1)
2025-08-05 23:10:34,093 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:22:09,095 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:22:09,096 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:22:09,996 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:22:10,256 - src.models.lstm_predictor - INFO - Generated 67 advanced features from 1255 data points
2025-08-05 23:22:10,256 - src.models.lstm_predictor - INFO - Using 17 features for training: ['Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'Price_SMA50_Ratio', 'SMA5_SMA20_Ratio', 'EMA12_EMA26_Ratio', 'Log_Return_1d', 'Log_Return_5d', 'Log_Return_10d', 'Volatility_10d', 'Volatility_20d', 'Vol_of_Vol', 'Volume_Ratio', 'OBV_Signal', 'RSI_Normalized', 'MACD_Normalized', 'BB_Position', 'Trend_Strength']
2025-08-05 23:22:10,261 - src.models.lstm_predictor - INFO - Prepared training data: (1235, 20, 17) features, (1235,) targets
2025-08-05 23:22:10,261 - src.models.lstm_predictor - INFO - Data splits - Train: 864, Val: 185, Test: 186
2025-08-05 23:22:10,343 - src.models.lstm_predictor - INFO - Model architecture: 20 time steps, 17 features
2025-08-05 23:22:58,031 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.011) below minimum threshold (0.1)
2025-08-05 23:22:58,033 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:25:56,258 - __main__ - ERROR - Training failed for AAPL: 'ModelConfig' object has no attribute 'data_path'
2025-08-05 23:40:02,924 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:40:02,924 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:40:04,709 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:40:04,960 - src.models.lstm_predictor - INFO - Generated 67 advanced features from 1255 data points
2025-08-05 23:40:04,961 - src.models.lstm_predictor - INFO - Using 8 features for training: ['Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'Log_Return_1d', 'Log_Return_5d', 'Volatility_10d', 'Volume_Ratio', 'RSI_Normalized', 'MACD_Normalized']
2025-08-05 23:40:04,968 - src.models.lstm_predictor - INFO - Prepared training data: (1240, 15, 8) features, (1240,) targets
2025-08-05 23:40:04,968 - src.models.lstm_predictor - INFO - Data splits - Train: 868, Val: 186, Test: 186
2025-08-05 23:40:05,107 - src.models.lstm_predictor - INFO - Model architecture: 15 time steps, 8 features
2025-08-05 23:40:32,383 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (0.014) below minimum threshold (0.1)
2025-08-05 23:40:32,384 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:44:56,181 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:44:56,181 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:44:57,078 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-05 23:44:57,078 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-05 23:44:57,090 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-05 23:44:57,091 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-05 23:44:57,091 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-05 23:44:57,405 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:44:57,671 - src.models.lstm_predictor - INFO - Generated 67 advanced features from 1255 data points
2025-08-05 23:44:57,671 - src.models.lstm_predictor - INFO - Using 8 features for training: ['Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'Log_Return_1d', 'Log_Return_5d', 'Volatility_10d', 'Volume_Ratio', 'RSI_Normalized', 'MACD_Normalized']
2025-08-05 23:44:57,675 - src.models.lstm_predictor - INFO - Prepared training data: (1240, 15, 8) features, (1240,) targets
2025-08-05 23:44:57,675 - src.models.lstm_predictor - INFO - Data splits - Train: 868, Val: 186, Test: 186
2025-08-05 23:44:57,777 - src.models.lstm_predictor - INFO - Model architecture: 15 time steps, 8 features
2025-08-05 23:45:34,929 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.009) below minimum threshold (0.1)
2025-08-05 23:45:34,930 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:49:33,116 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:49:33,116 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:49:34,063 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-05 23:49:34,063 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-05 23:49:34,077 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-05 23:49:34,078 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-05 23:49:34,078 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-05 23:49:34,412 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:49:34,668 - src.models.lstm_predictor - INFO - Generated 67 advanced features from 1255 data points
2025-08-05 23:49:34,668 - src.models.lstm_predictor - INFO - Using 10 features for training: ['Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'Log_Return_1d', 'Log_Return_5d', 'Volatility_10d', 'Volatility_20d', 'Volume_Ratio', 'RSI_Normalized', 'MACD_Normalized', 'BB_Position']
2025-08-05 23:49:34,670 - src.models.lstm_predictor - INFO - Prepared training data: (1245, 10, 10) features, (1245,) targets
2025-08-05 23:49:34,671 - src.models.lstm_predictor - INFO - Data splits - Train: 871, Val: 186, Test: 188
2025-08-05 23:49:34,752 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 10 features
2025-08-05 23:49:39,929 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.050) below minimum threshold (0.1)
2025-08-05 23:49:39,930 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:53:57,655 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:53:57,655 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:53:58,579 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-05 23:53:58,579 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-05 23:53:58,589 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-05 23:53:58,590 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-05 23:53:58,590 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-05 23:53:58,936 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:53:58,961 - src.models.lstm_predictor - INFO - Generated 42 features from 1255 data points
2025-08-05 23:53:58,962 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-05 23:53:58,969 - src.models.lstm_predictor - INFO - Prepared training data: (1244, 10, 15) features, (1244,) targets
2025-08-05 23:53:58,969 - src.models.lstm_predictor - INFO - Data splits - Train: 870, Val: 186, Test: 188
2025-08-05 23:53:59,059 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-05 23:54:06,573 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.066) below minimum threshold (0.1)
2025-08-05 23:54:06,574 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-05 23:57:32,206 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-05 23:57:32,207 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-05 23:57:33,248 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-05 23:57:33,248 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-05 23:57:33,261 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-05 23:57:33,261 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-05 23:57:33,261 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-05 23:57:33,599 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-05 23:57:33,631 - src.models.lstm_predictor - INFO - Generated 30 historical features from 1255 data points
2025-08-05 23:57:33,631 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-05 23:57:33,638 - src.models.lstm_predictor - INFO - Prepared training data: (1244, 10, 15) features, (1244,) targets
2025-08-05 23:57:33,638 - src.models.lstm_predictor - INFO - Data splits - Train: 870, Val: 186, Test: 188
2025-08-05 23:57:33,728 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-05 23:57:42,830 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.053) below minimum threshold (0.1)
2025-08-05 23:57:42,830 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:00:17,101 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:00:17,101 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:00:18,208 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:00:18,209 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 00:00:18,221 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 00:00:18,222 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 00:00:18,222 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 00:00:18,615 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:00:18,638 - src.models.lstm_predictor - INFO - Generated 30 historical features from 1255 data points
2025-08-06 00:00:18,638 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:00:18,644 - src.models.lstm_predictor - INFO - Prepared training data: (1244, 10, 15) features, (1244,) targets
2025-08-06 00:00:18,644 - src.models.lstm_predictor - INFO - Data splits - Train: 870, Val: 186, Test: 188
2025-08-06 00:00:18,765 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:02:00,905 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.125) below minimum threshold (0.1)
2025-08-06 00:02:00,906 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:06:56,189 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:06:56,189 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:06:57,105 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:06:57,105 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 00:06:57,117 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 00:06:57,117 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 00:06:57,117 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 00:06:57,482 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:06:57,514 - src.models.lstm_predictor - INFO - Generated 30 historical features from 1255 data points
2025-08-06 00:06:57,515 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:06:57,521 - src.models.lstm_predictor - INFO - Prepared training data: (1244, 10, 15) features, (1244,) targets
2025-08-06 00:06:57,521 - src.models.lstm_predictor - INFO - Data splits - Train: 870, Val: 186, Test: 188
2025-08-06 00:06:57,636 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:07:19,619 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.6599 - model may be poor quality
2025-08-06 00:07:20,242 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (0.004) below minimum threshold (0.1)
2025-08-06 00:07:20,242 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:17:25,775 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:17:25,775 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:17:27,105 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:17:27,105 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 00:17:27,113 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 00:17:27,114 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 00:17:27,114 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 00:17:27,530 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:17:27,565 - src.models.lstm_predictor - INFO - Generated 30 historical features from 1255 data points
2025-08-06 00:17:27,565 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:17:27,572 - src.models.lstm_predictor - INFO - Prepared training data: (1244, 10, 15) features, (1244,) targets
2025-08-06 00:17:27,572 - src.models.lstm_predictor - INFO - Data splits - Train: 870, Val: 186, Test: 188
2025-08-06 00:17:27,651 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:17:30,998 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.6593 - model may be poor quality
2025-08-06 00:17:31,295 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (0.005) below minimum threshold (0.1)
2025-08-06 00:17:31,296 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:22:04,998 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:22:04,998 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:22:06,068 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:22:06,068 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 00:22:06,080 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 00:22:06,081 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 00:22:06,081 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 00:22:06,445 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:22:06,473 - src.models.lstm_predictor - INFO - Generated 30 historical features from 1255 data points
2025-08-06 00:22:06,473 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:22:06,478 - src.models.lstm_predictor - INFO - Prepared training data: (1244, 10, 15) features, (1244,) targets
2025-08-06 00:22:06,479 - src.models.lstm_predictor - INFO - Data splits - Train: 870, Val: 186, Test: 188
2025-08-06 00:22:06,479 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000563, Train std: 0.018393
2025-08-06 00:22:06,564 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:22:11,007 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.6640 - model may be poor quality
2025-08-06 00:22:11,302 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (0.001) below minimum threshold (0.1)
2025-08-06 00:22:11,302 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:25:19,422 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:25:19,422 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:25:20,825 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:25:20,826 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 00:25:20,836 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 00:25:20,836 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 00:25:20,837 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 00:25:22,693 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:25:22,728 - src.models.lstm_predictor - INFO - Generated 30 historical features from 1255 data points
2025-08-06 00:25:22,728 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:25:22,738 - src.models.lstm_predictor - INFO - Prepared training data: (1244, 10, 15) features, (1244,) targets
2025-08-06 00:25:22,739 - src.models.lstm_predictor - INFO - Data splits - Train: 870, Val: 186, Test: 188
2025-08-06 00:25:22,739 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000563, Train std: 0.018393
2025-08-06 00:25:22,858 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:25:33,060 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.6664 - model may be poor quality
2025-08-06 00:25:33,570 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.003) below minimum threshold (0.1)
2025-08-06 00:25:33,570 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:27:51,354 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:27:51,354 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:27:52,302 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:27:52,302 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 00:27:52,314 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 00:27:52,315 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 00:27:52,315 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 00:27:52,614 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:27:52,644 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 00:27:52,644 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:27:52,649 - src.models.lstm_predictor - INFO - Prepared training data: (740, 10, 15) features, (740,) targets
2025-08-06 00:27:52,650 - src.models.lstm_predictor - INFO - Data splits - Train: 518, Val: 111, Test: 111
2025-08-06 00:27:52,650 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000569, Train std: 0.016115
2025-08-06 00:27:52,760 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:28:01,728 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.7485 - model may be poor quality
2025-08-06 00:28:02,190 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (0.011) below minimum threshold (0.1)
2025-08-06 00:28:02,190 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:29:08,792 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:29:08,792 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:29:09,782 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:29:09,782 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 00:29:09,794 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 00:29:09,795 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 00:29:09,795 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 00:29:10,134 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:29:10,165 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 00:29:10,166 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:29:10,170 - src.models.lstm_predictor - INFO - Prepared training data: (740, 10, 15) features, (740,) targets
2025-08-06 00:29:10,171 - src.models.lstm_predictor - INFO - Data splits - Train: 518, Val: 111, Test: 111
2025-08-06 00:29:10,172 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000569, Train std: 0.016115
2025-08-06 00:29:10,283 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:29:18,531 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.7549 - model may be poor quality
2025-08-06 00:29:18,991 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (0.003) below minimum threshold (0.005)
2025-08-06 00:29:18,991 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 00:46:26,907 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:46:26,907 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:46:27,869 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:46:27,869 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 00:46:27,882 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 00:46:27,883 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 00:46:27,883 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 00:46:28,242 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:46:28,276 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 00:46:28,276 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:46:28,281 - src.models.lstm_predictor - INFO - Prepared training data: (740, 10, 15) features, (740,) targets
2025-08-06 00:46:28,282 - src.models.lstm_predictor - INFO - Data splits - Train: 518, Val: 111, Test: 111
2025-08-06 00:46:28,282 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000569, Train std: 0.016115
2025-08-06 00:46:28,398 - src.models.lstm_predictor - INFO - Model architecture: 10 time steps, 15 features
2025-08-06 00:46:46,809 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.7282 - model may be poor quality
2025-08-06 00:46:47,284 - src.data.collector - INFO - Returning cached data for AAPL
2025-08-06 00:46:47,287 - src.models.lstm_predictor - INFO - Model passed quality validation: Model quality acceptable: R² = 0.038
2025-08-06 00:46:47,287 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-06 00:46:47,325 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-06 00:46:47,325 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Excellent 🎯
2025-08-06 00:52:12,703 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:52:12,703 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:52:13,590 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:52:13,590 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 00:52:13,601 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 00:52:13,602 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 00:52:13,602 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 00:52:13,911 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:52:13,926 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 00:52:13,927 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:52:13,931 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 751 prices
2025-08-06 00:52:13,931 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.000261, Std: 0.004077
2025-08-06 00:52:13,933 - src.models.lstm_predictor - INFO - Prepared training data: (720, 30, 15) features, (720,) targets
2025-08-06 00:52:13,934 - src.models.lstm_predictor - INFO - Data splits - Train: 503, Val: 108, Test: 109
2025-08-06 00:52:13,934 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000886, Train std: 0.003843
2025-08-06 00:52:14,077 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 15 features
2025-08-06 00:54:57,194 - src.models.lstm_predictor - WARNING - High validation loss detected: 2.3505 - model may be poor quality
2025-08-06 00:54:58,867 - src.data.collector - INFO - Returning cached data for AAPL
2025-08-06 00:54:58,868 - src.models.lstm_predictor - INFO - Model passed quality validation: Model quality acceptable: R² = 0.067
2025-08-06 00:54:58,869 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-06 00:54:58,939 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-06 00:54:58,939 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Excellent 🎯
2025-08-06 00:59:58,539 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 00:59:58,539 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 00:59:59,393 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 00:59:59,393 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 00:59:59,404 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 00:59:59,405 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 00:59:59,405 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 00:59:59,736 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 00:59:59,768 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 00:59:59,768 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 00:59:59,785 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 751 prices
2025-08-06 00:59:59,785 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.000261, Std: 0.004077
2025-08-06 00:59:59,787 - src.models.lstm_predictor - INFO - Prepared training data: (710, 40, 15) features, (710,) targets
2025-08-06 00:59:59,787 - src.models.lstm_predictor - INFO - Data splits - Train: 496, Val: 106, Test: 108
2025-08-06 00:59:59,787 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000960, Train std: 0.003795
2025-08-06 00:59:59,916 - src.models.lstm_predictor - INFO - Model architecture: 40 time steps, 15 features
2025-08-06 01:01:53,080 - src.models.lstm_predictor - WARNING - High validation loss detected: 2.0261 - model may be poor quality
2025-08-06 01:01:55,166 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.277 vs Test R² -0.413
2025-08-06 01:01:55,166 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 01:09:08,688 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 01:09:08,689 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 01:09:09,533 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 01:09:09,533 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 01:09:09,547 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 01:09:09,547 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 01:09:09,547 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 01:09:09,855 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 01:09:09,888 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 01:09:09,888 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 01:09:09,904 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 751 prices
2025-08-06 01:09:09,904 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.000261, Std: 0.004077
2025-08-06 01:09:09,906 - src.models.lstm_predictor - INFO - Prepared training data: (730, 20, 15) features, (730,) targets
2025-08-06 01:09:09,906 - src.models.lstm_predictor - INFO - Data splits - Train: 510, Val: 109, Test: 111
2025-08-06 01:09:09,906 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000768, Train std: 0.003912
2025-08-06 01:09:10,005 - src.models.lstm_predictor - INFO - Model architecture: 20 time steps, 15 features
2025-08-06 01:09:34,451 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.4125 - model may be poor quality
2025-08-06 01:09:35,229 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.105 vs Test R² -0.399
2025-08-06 01:09:35,229 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 01:14:17,026 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 01:14:17,027 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 01:14:17,870 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 01:14:17,870 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 01:14:17,881 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 01:14:17,882 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 01:14:17,882 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 01:14:18,251 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 01:14:18,280 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 01:14:18,280 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 01:14:18,296 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 751 prices
2025-08-06 01:14:18,296 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.003909, Std: 0.061161
2025-08-06 01:14:18,297 - src.models.lstm_predictor - INFO - Prepared training data: (730, 20, 15) features, (730,) targets
2025-08-06 01:14:18,298 - src.models.lstm_predictor - INFO - Data splits - Train: 510, Val: 109, Test: 111
2025-08-06 01:14:18,298 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.011521, Train std: 0.058684
2025-08-06 01:14:18,377 - src.models.lstm_predictor - INFO - Model architecture: 20 time steps, 15 features
2025-08-06 01:14:23,594 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.8173 - model may be poor quality
2025-08-06 01:14:23,836 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.235 vs Test R² -1.704
2025-08-06 01:14:23,836 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 01:18:04,874 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 01:18:04,874 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 01:18:05,727 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 01:18:05,727 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 01:18:05,736 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 01:18:05,737 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 01:18:05,737 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 01:18:06,031 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 01:18:06,060 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 01:18:06,060 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 01:18:06,078 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 751 prices
2025-08-06 01:18:06,078 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.003909, Std: 0.061161
2025-08-06 01:18:06,080 - src.models.lstm_predictor - INFO - Prepared training data: (735, 15, 15) features, (735,) targets
2025-08-06 01:18:06,080 - src.models.lstm_predictor - INFO - Data splits - Train: 514, Val: 110, Test: 111
2025-08-06 01:18:06,080 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.011049, Train std: 0.058630
2025-08-06 01:18:06,151 - src.models.lstm_predictor - INFO - Model architecture: 15 time steps, 15 features
2025-08-06 01:18:11,222 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.2585 - model may be poor quality
2025-08-06 01:18:11,531 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.046) below minimum threshold (0.02)
2025-08-06 01:18:11,531 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 01:20:12,099 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 01:20:12,099 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 01:20:13,459 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 01:20:13,459 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 01:20:13,472 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 01:20:13,473 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 01:20:13,473 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 01:20:13,837 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 01:20:13,870 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 01:20:13,870 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 01:20:13,890 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 751 prices
2025-08-06 01:20:13,890 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.003909, Std: 0.061161
2025-08-06 01:20:13,892 - src.models.lstm_predictor - INFO - Prepared training data: (710, 40, 15) features, (710,) targets
2025-08-06 01:20:13,892 - src.models.lstm_predictor - INFO - Data splits - Train: 496, Val: 106, Test: 108
2025-08-06 01:20:13,892 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.014405, Train std: 0.056924
2025-08-06 01:20:13,999 - src.models.lstm_predictor - INFO - Model architecture: 40 time steps, 15 features
2025-08-06 01:21:00,766 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.1506 - model may be poor quality
2025-08-06 01:21:02,353 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.266 vs Test R² -0.260
2025-08-06 01:21:02,353 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 01:24:10,809 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 01:24:10,809 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 01:24:11,680 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 01:24:11,680 - src.data.validator - INFO - Starting validation for AAPL with 751 rows
2025-08-06 01:24:11,690 - src.data.validator - INFO - Validation complete for AAPL: 751 clean rows
2025-08-06 01:24:11,691 - src.data.validator - INFO - Pipeline complete for AAPL: 751 -> 751 rows
2025-08-06 01:24:11,691 - src.data.collector - INFO - Data pipeline: 751 -> 751 rows
2025-08-06 01:24:11,998 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 01:24:12,068 - src.models.lstm_predictor - INFO - Generated 30 historical features from 751 data points
2025-08-06 01:24:12,069 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 01:24:12,088 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 751 prices
2025-08-06 01:24:12,088 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.003909, Std: 0.061161
2025-08-06 01:24:12,091 - src.models.lstm_predictor - INFO - Prepared training data: (720, 30, 15) features, (720,) targets
2025-08-06 01:24:12,092 - src.models.lstm_predictor - INFO - Data splits - Train: 503, Val: 108, Test: 109
2025-08-06 01:24:12,092 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.013297, Train std: 0.057643
2025-08-06 01:24:12,192 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 15 features
2025-08-06 01:24:55,745 - src.models.lstm_predictor - WARNING - High validation loss detected: 2.1287 - model may be poor quality
2025-08-06 01:24:56,545 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.159 vs Test R² -0.343
2025-08-06 01:24:56,545 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 16:05:50,711 - src.data.collector - INFO - Fetching fresh data for AAPL
2025-08-06 16:05:53,092 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 16:05:53,092 - src.data.validator - INFO - Starting validation for AAPL with 502 rows
2025-08-06 16:05:53,104 - src.data.validator - INFO - Validation complete for AAPL: 502 clean rows
2025-08-06 16:05:53,105 - src.data.validator - INFO - Pipeline complete for AAPL: 502 -> 502 rows
2025-08-06 16:05:53,105 - src.data.collector - INFO - Data pipeline: 502 -> 502 rows
2025-08-06 16:05:53,377 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 19:04:50,402 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 19:04:50,402 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 19:04:51,002 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 19:04:51,002 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 19:04:51,016 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 19:04:51,017 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 19:04:51,017 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 19:04:51,238 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 19:04:51,270 - src.models.lstm_predictor - INFO - Generated 30 historical features from 1255 data points
2025-08-06 19:04:51,270 - src.models.lstm_predictor - INFO - Using 15 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2']
2025-08-06 19:04:51,273 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 1255 prices
2025-08-06 19:04:51,273 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.007479, Std: 0.063977
2025-08-06 19:04:51,276 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 15) features, (1224,) targets
2025-08-06 19:04:53,660 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 19:04:53,660 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.008364, Train std: 0.063222
2025-08-06 19:04:53,755 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 15 features
2025-08-06 19:05:51,610 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.5160 - model may be poor quality
2025-08-06 19:05:52,492 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.091) below minimum threshold (0.01)
2025-08-06 19:05:52,492 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 19:08:25,829 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 19:08:25,830 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 19:08:26,446 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 19:08:26,446 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 19:08:26,458 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 19:08:26,459 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 19:08:26,459 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 19:08:26,717 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 19:08:26,734 - src.models.lstm_predictor - INFO - Adding sentiment features...
2025-08-06 19:08:26,734 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 19:08:29,773 - src.models.lstm_predictor - INFO - Added sentiment features: overall=0.141, confidence=1.000
2025-08-06 19:08:29,783 - src.models.lstm_predictor - INFO - Generated 39 historical features from 1255 data points
2025-08-06 19:08:29,784 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 19:08:29,785 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score', 'Bearish_Ratio', 'Sentiment_Change', 'News_Volume']
2025-08-06 19:08:29,787 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 1255 prices
2025-08-06 19:08:29,787 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.007479, Std: 0.063977
2025-08-06 19:08:29,789 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 18) features, (1224,) targets
2025-08-06 19:08:32,689 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 19:08:32,690 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.008364, Train std: 0.063222
2025-08-06 19:08:32,790 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 18 features
2025-08-06 19:09:46,123 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.9881 - model may be poor quality
2025-08-06 19:09:46,995 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.015 vs Test R² -0.201
2025-08-06 19:09:46,995 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 20:39:29,115 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 20:39:29,115 - src.data.collector - INFO - Fetching fresh data for AAPL (3y)
2025-08-06 20:39:29,742 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 20:39:29,742 - src.data.validator - INFO - Starting validation for AAPL with 752 rows
2025-08-06 20:39:29,754 - src.data.validator - INFO - Validation complete for AAPL: 752 clean rows
2025-08-06 20:39:29,755 - src.data.validator - INFO - Pipeline complete for AAPL: 752 -> 752 rows
2025-08-06 20:39:29,755 - src.data.collector - INFO - Data pipeline: 752 -> 752 rows
2025-08-06 20:39:29,964 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 20:39:29,973 - src.models.lstm_predictor - INFO - Adding sentiment features...
2025-08-06 20:39:29,973 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 20:39:32,933 - src.models.lstm_predictor - INFO - Added sentiment features: overall=0.141, confidence=1.000
2025-08-06 20:39:32,943 - src.models.lstm_predictor - INFO - Generated 39 historical features from 752 data points
2025-08-06 20:39:32,943 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 20:39:32,944 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score', 'Bearish_Ratio', 'Sentiment_Change', 'News_Volume']
2025-08-06 20:39:32,945 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 752 prices
2025-08-06 20:39:32,945 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.004898, Std: 0.060889
2025-08-06 20:39:32,946 - src.models.lstm_predictor - INFO - Prepared training data: (721, 30, 18) features, (721,) targets
2025-08-06 20:39:34,702 - src.models.lstm_predictor - INFO - Data splits - Train: 504, Val: 108, Test: 109
2025-08-06 20:39:34,702 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.013265, Train std: 0.057591
2025-08-06 20:39:34,812 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 18 features
2025-08-06 20:40:30,684 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.3695 - model may be poor quality
2025-08-06 20:40:31,478 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.119 vs Test R² -0.236
2025-08-06 20:40:31,478 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 20:46:32,395 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 20:46:32,395 - src.data.collector - INFO - Fetching fresh data for AAPL (3y)
2025-08-06 20:46:32,972 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 20:46:32,972 - src.data.validator - INFO - Starting validation for AAPL with 752 rows
2025-08-06 20:46:32,986 - src.data.validator - INFO - Validation complete for AAPL: 752 clean rows
2025-08-06 20:46:32,987 - src.data.validator - INFO - Pipeline complete for AAPL: 752 -> 752 rows
2025-08-06 20:46:32,987 - src.data.collector - INFO - Data pipeline: 752 -> 752 rows
2025-08-06 20:46:33,248 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 20:46:33,272 - src.models.lstm_predictor - INFO - Adding sentiment features...
2025-08-06 20:46:33,272 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 20:46:36,296 - src.models.lstm_predictor - INFO - Added sentiment features: overall=0.141, confidence=1.000
2025-08-06 20:46:36,307 - src.models.lstm_predictor - INFO - Generated 39 historical features from 752 data points
2025-08-06 20:46:36,307 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 20:46:36,309 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score', 'Bearish_Ratio', 'Sentiment_Change', 'News_Volume']
2025-08-06 20:46:36,310 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 752 prices
2025-08-06 20:46:36,310 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.004898, Std: 0.060889
2025-08-06 20:46:36,311 - src.models.lstm_predictor - INFO - Prepared training data: (721, 30, 18) features, (721,) targets
2025-08-06 20:46:38,011 - src.models.lstm_predictor - INFO - Data splits - Train: 504, Val: 108, Test: 109
2025-08-06 20:46:38,011 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.013265, Train std: 0.057591
2025-08-06 20:46:38,104 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 18 features
2025-08-06 20:46:38,104 - src.models.lstm_predictor - INFO - Enhanced learning rate strategy - Initial LR: 0.001500
2025-08-06 20:47:32,949 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.1074 - model may be poor quality
2025-08-06 20:47:33,739 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.160 vs Test R² -0.394
2025-08-06 20:47:33,740 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 20:50:04,282 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 20:50:04,282 - src.data.collector - INFO - Fetching fresh data for AAPL (3y)
2025-08-06 20:50:04,833 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 20:50:04,833 - src.data.validator - INFO - Starting validation for AAPL with 752 rows
2025-08-06 20:50:04,847 - src.data.validator - INFO - Validation complete for AAPL: 752 clean rows
2025-08-06 20:50:04,848 - src.data.validator - INFO - Pipeline complete for AAPL: 752 -> 752 rows
2025-08-06 20:50:04,848 - src.data.collector - INFO - Data pipeline: 752 -> 752 rows
2025-08-06 20:50:05,086 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 20:50:05,100 - src.models.lstm_predictor - INFO - Adding sentiment features...
2025-08-06 20:50:05,101 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 20:50:10,026 - src.models.lstm_predictor - INFO - Added sentiment features: overall=0.141, confidence=1.000
2025-08-06 20:50:10,037 - src.models.lstm_predictor - INFO - Generated 39 historical features from 752 data points
2025-08-06 20:50:10,037 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 20:50:10,038 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score', 'Bearish_Ratio', 'Sentiment_Change', 'News_Volume']
2025-08-06 20:50:10,039 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon, smoothed from 752 prices
2025-08-06 20:50:10,039 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.004898, Std: 0.060889
2025-08-06 20:50:10,041 - src.models.lstm_predictor - INFO - Prepared training data: (721, 30, 18) features, (721,) targets
2025-08-06 20:50:11,757 - src.models.lstm_predictor - INFO - Data splits - Train: 504, Val: 108, Test: 109
2025-08-06 20:50:11,757 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.013265, Train std: 0.057591
2025-08-06 20:50:11,858 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 18 features
2025-08-06 20:50:11,858 - src.models.lstm_predictor - INFO - Enhanced learning rate strategy - Initial LR: 0.001000
2025-08-06 20:51:06,983 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.7680 - model may be poor quality
2025-08-06 20:51:07,846 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.053) below minimum threshold (0.01)
2025-08-06 20:51:07,846 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 21:00:39,114 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:00:39,115 - src.data.collector - INFO - Fetching fresh data for AAPL (2y)
2025-08-06 21:00:39,721 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:00:39,722 - src.data.validator - INFO - Starting validation for AAPL with 502 rows
2025-08-06 21:00:39,734 - src.data.validator - INFO - Validation complete for AAPL: 502 clean rows
2025-08-06 21:00:39,735 - src.data.validator - INFO - Pipeline complete for AAPL: 502 -> 502 rows
2025-08-06 21:00:39,735 - src.data.collector - INFO - Data pipeline: 502 -> 502 rows
2025-08-06 21:00:39,954 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:00:39,973 - src.models.lstm_predictor - INFO - Adding historical sentiment features for training period...
2025-08-06 21:00:39,973 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 21:00:44,262 - src.models.lstm_predictor - INFO - Added sentiment features: avg_sentiment=0.141, confidence=1.000
2025-08-06 21:00:44,262 - src.models.lstm_predictor - INFO - Adding historical earnings features for training period...
2025-08-06 21:00:44,444 - src.analysis.fundamentals - INFO - Retrieved 8 earnings events for AAPL
2025-08-06 21:00:44,446 - src.models.lstm_predictor - INFO - Found 8 earnings events for analysis
2025-08-06 21:00:44,448 - src.models.lstm_predictor - WARNING - Could not add earnings features: Cannot subtract tz-naive and tz-aware datetime-like objects.
2025-08-06 21:00:44,468 - src.models.lstm_predictor - INFO - Generated 43 historical features from 502 data points
2025-08-06 21:00:44,468 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:00:44,470 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score', 'News_Volume']
2025-08-06 21:00:44,471 - src.models.lstm_predictor - INFO - Target engineering: 15-day horizon
2025-08-06 21:00:44,471 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.005775, Std: 0.058403
2025-08-06 21:00:44,471 - src.models.lstm_predictor - INFO - Target range - Min: -0.170761, Max: 0.182261
2025-08-06 21:00:44,472 - src.models.lstm_predictor - INFO - Prepared training data: (471, 30, 20) features, (471,) targets
2025-08-06 21:00:44,508 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:00:44,508 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.013234, Std: 0.055649
2025-08-06 21:00:44,508 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.151349, Max: 0.131542
2025-08-06 21:00:44,509 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.013340, Train std: 0.450524
2025-08-06 21:00:44,509 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.321575, Val std: 0.658849
2025-08-06 21:00:44,509 - src.models.lstm_predictor - INFO - Data splits - Train: 329, Val: 70, Test: 72
2025-08-06 21:00:44,509 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.013234, Train std: 0.055649
2025-08-06 21:00:44,623 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 20 features
2025-08-06 21:00:44,623 - src.models.lstm_predictor - INFO - Conservative learning rate strategy - Initial LR: 0.000600
2025-08-06 21:01:25,654 - src.models.lstm_predictor - WARNING - High validation loss detected: 2.8543 - model may be poor quality
2025-08-06 21:01:26,372 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.411) below minimum threshold (0.01)
2025-08-06 21:01:26,372 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 21:03:22,893 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:03:22,893 - src.data.collector - INFO - Fetching fresh data for AAPL (3y)
2025-08-06 21:03:23,465 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:03:23,465 - src.data.validator - INFO - Starting validation for AAPL with 752 rows
2025-08-06 21:03:23,478 - src.data.validator - INFO - Validation complete for AAPL: 752 clean rows
2025-08-06 21:03:23,478 - src.data.validator - INFO - Pipeline complete for AAPL: 752 -> 752 rows
2025-08-06 21:03:23,478 - src.data.collector - INFO - Data pipeline: 752 -> 752 rows
2025-08-06 21:03:23,710 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:03:23,722 - src.models.lstm_predictor - INFO - Adding historical sentiment features for training period...
2025-08-06 21:03:23,722 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 21:03:26,535 - src.models.lstm_predictor - INFO - Added sentiment features: avg_sentiment=0.141, confidence=1.000
2025-08-06 21:03:26,535 - src.models.lstm_predictor - INFO - Adding historical earnings features for training period...
2025-08-06 21:03:26,733 - src.analysis.fundamentals - INFO - Retrieved 8 earnings events for AAPL
2025-08-06 21:03:26,733 - src.models.lstm_predictor - INFO - Found 8 earnings events for analysis
2025-08-06 21:03:26,734 - src.models.lstm_predictor - WARNING - Could not add earnings features: Cannot subtract tz-naive and tz-aware datetime-like objects.
2025-08-06 21:03:26,741 - src.models.lstm_predictor - INFO - Generated 43 historical features from 752 data points
2025-08-06 21:03:26,741 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:03:26,742 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score', 'Bearish_Ratio']
2025-08-06 21:03:26,743 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 21:03:26,743 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.006198, Std: 0.059051
2025-08-06 21:03:26,743 - src.models.lstm_predictor - INFO - Target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:03:26,743 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.122039
2025-08-06 21:03:26,744 - src.models.lstm_predictor - INFO - Prepared training data: (721, 30, 20) features, (721,) targets
2025-08-06 21:03:26,786 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:03:26,786 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.014552, Std: 0.056994
2025-08-06 21:03:26,786 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:03:26,788 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.040523, Train std: 0.463943
2025-08-06 21:03:26,788 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.147527, Val std: 0.497227
2025-08-06 21:03:26,788 - src.models.lstm_predictor - INFO - Data splits - Train: 504, Val: 108, Test: 109
2025-08-06 21:03:26,788 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.014552, Train std: 0.056994
2025-08-06 21:03:26,886 - src.models.lstm_predictor - INFO - Built SIMPLIFIED model: 64 LSTM units, single layer
2025-08-06 21:03:26,886 - src.models.lstm_predictor - INFO - Very conservative learning rate: 0.0001
2025-08-06 21:03:26,886 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 20 features
2025-08-06 21:03:26,886 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 21:03:30,074 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.2845 - model may be poor quality
2025-08-06 21:03:30,529 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.172 vs Test R² -0.301
2025-08-06 21:03:30,529 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 21:07:26,159 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:07:26,159 - src.data.collector - INFO - Fetching fresh data for AAPL (3y)
2025-08-06 21:07:26,814 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:07:26,815 - src.data.validator - INFO - Starting validation for AAPL with 752 rows
2025-08-06 21:07:26,826 - src.data.validator - INFO - Validation complete for AAPL: 752 clean rows
2025-08-06 21:07:26,827 - src.data.validator - INFO - Pipeline complete for AAPL: 752 -> 752 rows
2025-08-06 21:07:26,827 - src.data.collector - INFO - Data pipeline: 752 -> 752 rows
2025-08-06 21:07:27,042 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:07:27,065 - src.models.lstm_predictor - INFO - Adding historical sentiment features for training period...
2025-08-06 21:07:27,065 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 21:07:27,282 - src.analysis.sentiment - WARNING - No news data returned for AAPL
2025-08-06 21:07:31,694 - src.models.lstm_predictor - INFO - Added sentiment features: avg_sentiment=-0.003, confidence=0.650
2025-08-06 21:07:31,694 - src.models.lstm_predictor - INFO - Adding historical earnings features for training period...
2025-08-06 21:07:32,105 - src.analysis.fundamentals - INFO - Retrieved 3 earnings events for AAPL
2025-08-06 21:07:32,107 - src.models.lstm_predictor - INFO - Found 3 earnings events for analysis
2025-08-06 21:07:32,109 - src.models.lstm_predictor - WARNING - Could not add earnings features: Cannot subtract tz-naive and tz-aware datetime-like objects.
2025-08-06 21:07:32,129 - src.models.lstm_predictor - INFO - Generated 43 historical features from 752 data points
2025-08-06 21:07:32,129 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:07:32,131 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Bullish_Ratio', 'Bearish_Ratio']
2025-08-06 21:07:32,132 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 21:07:32,132 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.006198, Std: 0.059051
2025-08-06 21:07:32,132 - src.models.lstm_predictor - INFO - Target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:07:32,132 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.122039
2025-08-06 21:07:32,134 - src.models.lstm_predictor - INFO - Prepared training data: (721, 30, 20) features, (721,) targets
2025-08-06 21:07:32,183 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:07:32,183 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.014552, Std: 0.056994
2025-08-06 21:07:32,183 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:07:32,185 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.040522, Train std: 0.463943
2025-08-06 21:07:32,185 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.147526, Val std: 0.497227
2025-08-06 21:07:32,185 - src.models.lstm_predictor - INFO - Data splits - Train: 504, Val: 108, Test: 109
2025-08-06 21:07:32,185 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.014552, Train std: 0.056994
2025-08-06 21:07:32,234 - src.models.lstm_predictor - INFO - Built SIMPLIFIED model: 64 LSTM units, single layer
2025-08-06 21:07:32,234 - src.models.lstm_predictor - INFO - Very conservative learning rate: 0.0001
2025-08-06 21:07:32,234 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 20 features
2025-08-06 21:07:32,234 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 21:07:35,325 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.3244 - model may be poor quality
2025-08-06 21:07:35,735 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.011 vs Test R² -0.191
2025-08-06 21:07:35,735 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 21:29:40,400 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:29:40,400 - src.data.collector - INFO - Fetching fresh data for AAPL (3y)
2025-08-06 21:29:40,986 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:29:40,986 - src.data.validator - INFO - Starting validation for AAPL with 752 rows
2025-08-06 21:29:40,997 - src.data.validator - INFO - Validation complete for AAPL: 752 clean rows
2025-08-06 21:29:40,998 - src.data.validator - INFO - Pipeline complete for AAPL: 752 -> 752 rows
2025-08-06 21:29:40,998 - src.data.collector - INFO - Data pipeline: 752 -> 752 rows
2025-08-06 21:29:41,277 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:29:41,299 - src.models.lstm_predictor - INFO - Adding historical sentiment features for training period...
2025-08-06 21:29:41,300 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 21:29:41,300 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 21:29:41,460 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 21:29:41,460 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 21:29:41,460 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 21:29:41,460 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 21:29:41,750 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 21:29:44,344 - src.models.lstm_predictor - INFO - Added sentiment features: avg_sentiment=-0.003, confidence=0.650
2025-08-06 21:29:44,344 - src.models.lstm_predictor - INFO - Adding historical earnings features for training period...
2025-08-06 21:29:44,710 - src.analysis.fundamentals - INFO - Retrieved 3 earnings events for AAPL
2025-08-06 21:29:44,712 - src.models.lstm_predictor - INFO - Found 3 earnings events for analysis
2025-08-06 21:29:44,714 - src.models.lstm_predictor - WARNING - Could not add earnings features: Cannot subtract tz-naive and tz-aware datetime-like objects.
2025-08-06 21:29:44,732 - src.models.lstm_predictor - INFO - Generated 43 historical features from 752 data points
2025-08-06 21:29:44,732 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:29:44,734 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Bullish_Ratio', 'Bearish_Ratio']
2025-08-06 21:29:44,735 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 21:29:44,736 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.006198, Std: 0.059051
2025-08-06 21:29:44,736 - src.models.lstm_predictor - INFO - Target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:29:44,736 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.122039
2025-08-06 21:29:44,738 - src.models.lstm_predictor - INFO - Prepared training data: (721, 30, 20) features, (721,) targets
2025-08-06 21:29:44,785 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:29:44,785 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.014552, Std: 0.056994
2025-08-06 21:29:44,786 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:29:44,786 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.040521, Train std: 0.463943
2025-08-06 21:29:44,786 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.147525, Val std: 0.497227
2025-08-06 21:29:44,786 - src.models.lstm_predictor - INFO - Data splits - Train: 504, Val: 108, Test: 109
2025-08-06 21:29:44,786 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.014552, Train std: 0.056994
2025-08-06 21:29:44,847 - src.models.lstm_predictor - INFO - Built SIMPLIFIED model: 64 LSTM units, single layer
2025-08-06 21:29:44,848 - src.models.lstm_predictor - INFO - Very conservative learning rate: 0.0001
2025-08-06 21:29:44,848 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 20 features
2025-08-06 21:29:44,848 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 21:29:48,154 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.3197 - model may be poor quality
2025-08-06 21:29:48,599 - src.data.collector - INFO - Fetching fresh data for AAPL (5d)
2025-08-06 21:29:48,703 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:29:48,704 - src.data.validator - INFO - Starting validation for AAPL with 5 rows
2025-08-06 21:29:48,704 - src.data.validator - ERROR - Data validation failed for AAPL: ['Insufficient data: 5 rows < 50 minimum']
2025-08-06 21:29:48,704 - src.data.collector - ERROR - Data validation failed for AAPL: Data validation failed: Insufficient data: 5 rows < 50 minimum
2025-08-06 21:29:48,704 - src.data.collector - WARNING - Proceeding with raw data for AAPL
2025-08-06 21:29:48,850 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:29:48,850 - src.models.lstm_predictor - INFO - Model passed quality validation: Model quality acceptable: R² = 0.028
2025-08-06 21:29:48,850 - absl - WARNING - You are saving your model as an HDF5 file via `model.save()` or `keras.saving.save_model(model)`. This file format is considered legacy. We recommend using instead the native Keras format, e.g. `model.save('my_model.keras')` or `keras.saving.save_model(model, 'my_model.keras')`. 
2025-08-06 21:29:48,954 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-06 21:29:48,954 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Fair 👌
2025-08-06 21:30:36,795 - src.models.lstm_predictor - ERROR - Error loading enhanced model for AAPL: Could not locate function 'mse'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'keras.metrics', 'class_name': 'function', 'config': 'mse', 'registered_name': 'mse'}
2025-08-06 21:31:32,932 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:31:32,932 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_scaler.pkl
2025-08-06 21:31:32,933 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_feature_scaler.pkl
2025-08-06 21:31:32,976 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_metrics.json
2025-08-06 21:31:32,976 - src.data.collector - INFO - Fetching fresh data for AAPL (3y)
2025-08-06 21:31:33,571 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:31:33,571 - src.data.validator - INFO - Starting validation for AAPL with 752 rows
2025-08-06 21:31:33,582 - src.data.validator - INFO - Validation complete for AAPL: 752 clean rows
2025-08-06 21:31:33,583 - src.data.validator - INFO - Pipeline complete for AAPL: 752 -> 752 rows
2025-08-06 21:31:33,583 - src.data.collector - INFO - Data pipeline: 752 -> 752 rows
2025-08-06 21:31:33,797 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:31:33,807 - src.models.lstm_predictor - INFO - Adding historical sentiment features for training period...
2025-08-06 21:31:33,807 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 21:31:33,807 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 21:31:33,974 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 21:31:33,974 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 21:31:33,974 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 21:31:33,974 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 21:31:34,251 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 21:31:37,563 - src.models.lstm_predictor - INFO - Added sentiment features: avg_sentiment=-0.003, confidence=0.650
2025-08-06 21:31:37,563 - src.models.lstm_predictor - INFO - Adding historical earnings features for training period...
2025-08-06 21:31:38,003 - src.analysis.fundamentals - INFO - Retrieved 3 earnings events for AAPL
2025-08-06 21:31:38,005 - src.models.lstm_predictor - INFO - Found 3 earnings events for analysis
2025-08-06 21:31:38,007 - src.models.lstm_predictor - WARNING - Could not add earnings features: Cannot subtract tz-naive and tz-aware datetime-like objects.
2025-08-06 21:31:38,022 - src.models.lstm_predictor - INFO - Generated 43 historical features from 752 data points
2025-08-06 21:31:38,022 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:31:38,024 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Bullish_Ratio', 'Bearish_Ratio']
2025-08-06 21:31:38,026 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 21:31:38,026 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.006198, Std: 0.059051
2025-08-06 21:31:38,026 - src.models.lstm_predictor - INFO - Target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:31:38,026 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.122039
2025-08-06 21:31:38,027 - src.models.lstm_predictor - INFO - Prepared training data: (721, 30, 20) features, (721,) targets
2025-08-06 21:31:38,074 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:31:38,074 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.014552, Std: 0.056994
2025-08-06 21:31:38,074 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.122039, Max: 0.122039
2025-08-06 21:31:38,076 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.040523, Train std: 0.463943
2025-08-06 21:31:38,076 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.147527, Val std: 0.497227
2025-08-06 21:31:38,076 - src.models.lstm_predictor - INFO - Data splits - Train: 504, Val: 108, Test: 109
2025-08-06 21:31:38,076 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.014552, Train std: 0.056994
2025-08-06 21:31:38,136 - src.models.lstm_predictor - INFO - Built SIMPLIFIED model: 64 LSTM units, single layer
2025-08-06 21:31:38,136 - src.models.lstm_predictor - INFO - Very conservative learning rate: 0.0001
2025-08-06 21:31:38,136 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 20 features
2025-08-06 21:31:38,136 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 21:31:42,263 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.3201 - model may be poor quality
2025-08-06 21:31:42,766 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.025 vs Test R² -0.156
2025-08-06 21:31:42,766 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 21:32:32,668 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:32:32,668 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 21:32:33,272 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:32:33,272 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 21:32:33,283 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 21:32:33,284 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 21:32:33,284 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 21:32:33,499 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:32:33,519 - src.models.lstm_predictor - INFO - Adding historical sentiment features for training period...
2025-08-06 21:32:33,519 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 7d
2025-08-06 21:32:33,519 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 21:32:33,669 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 21:32:33,669 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 21:32:33,669 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 21:32:33,669 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 21:32:33,913 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 21:32:36,401 - src.models.lstm_predictor - INFO - Added sentiment features: avg_sentiment=-0.003, confidence=0.650
2025-08-06 21:32:36,402 - src.models.lstm_predictor - INFO - Adding historical earnings features for training period...
2025-08-06 21:32:36,768 - src.analysis.fundamentals - INFO - Retrieved 3 earnings events for AAPL
2025-08-06 21:32:36,770 - src.models.lstm_predictor - INFO - Found 3 earnings events for analysis
2025-08-06 21:32:36,772 - src.models.lstm_predictor - WARNING - Could not add earnings features: Cannot subtract tz-naive and tz-aware datetime-like objects.
2025-08-06 21:32:36,788 - src.models.lstm_predictor - INFO - Generated 43 historical features from 1255 data points
2025-08-06 21:32:36,788 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:32:36,791 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Bullish_Ratio', 'Bearish_Ratio']
2025-08-06 21:32:36,792 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 21:32:36,792 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 21:32:36,793 - src.models.lstm_predictor - INFO - Target range - Min: -0.123370, Max: 0.123370
2025-08-06 21:32:36,793 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123370
2025-08-06 21:32:36,796 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 20) features, (1224,) targets
2025-08-06 21:32:36,866 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:32:36,866 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 21:32:36,866 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123370, Max: 0.123370
2025-08-06 21:32:36,867 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033985, Train std: 0.440073
2025-08-06 21:32:36,867 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044720, Val std: 0.381094
2025-08-06 21:32:36,867 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 21:32:36,867 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 21:32:36,923 - src.models.lstm_predictor - INFO - Built SIMPLIFIED model: 64 LSTM units, single layer
2025-08-06 21:32:36,923 - src.models.lstm_predictor - INFO - Very conservative learning rate: 0.0001
2025-08-06 21:32:36,923 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 20 features
2025-08-06 21:32:36,924 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 21:32:55,817 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.2245 - model may be poor quality
2025-08-06 21:32:56,320 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.121) below minimum threshold (0.01)
2025-08-06 21:32:56,320 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 21:42:40,736 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:42:40,737 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 21:42:41,333 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:42:41,333 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 21:42:41,343 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 21:42:41,344 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 21:42:41,344 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 21:42:41,557 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:42:41,580 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-06 21:42:41,580 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-06 21:42:41,580 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-06 21:42:41,580 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-06 21:42:41,771 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 21:42:42,006 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 21:42:42,007 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 21:42:42,007 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 21:42:42,007 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 21:42:42,253 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 21:42:42,384 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.242 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 10)
2025-08-06 21:42:42,387 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.241, confidence=1.000, news_count=10
2025-08-06 21:42:42,387 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-06 21:42:42,393 - src.models.lstm_predictor - WARNING - Could not add comprehensive earnings features: unexpected unindent (fundamentals.py, line 99)
2025-08-06 21:42:42,403 - src.models.lstm_predictor - INFO - Generated 49 historical features from 1255 data points
2025-08-06 21:42:42,403 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:42:42,404 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score']
2025-08-06 21:42:42,405 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 21:42:42,405 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 21:42:42,405 - src.models.lstm_predictor - INFO - Target range - Min: -0.123370, Max: 0.123370
2025-08-06 21:42:42,405 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123370
2025-08-06 21:42:42,407 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 21) features, (1224,) targets
2025-08-06 21:42:42,467 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:42:42,467 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 21:42:42,467 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123370, Max: 0.123370
2025-08-06 21:42:42,467 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033983, Train std: 0.440073
2025-08-06 21:42:42,467 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044722, Val std: 0.381094
2025-08-06 21:42:42,468 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 21:42:42,468 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 21:42:42,468 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-06 21:42:42,615 - src.models.lstm_predictor - INFO - Complex model built: 1,282,753 parameters
2025-08-06 21:42:42,615 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-06 21:42:42,615 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 21 features
2025-08-06 21:42:42,615 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 21:49:03,694 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.9435 - model may be poor quality
2025-08-06 21:49:06,464 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.098) below minimum threshold (0.01)
2025-08-06 21:49:06,464 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 21:55:56,095 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 21:55:56,095 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 21:55:56,743 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 21:55:56,743 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 21:55:56,753 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 21:55:56,754 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 21:55:56,754 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 21:55:57,839 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 21:55:57,863 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-06 21:55:57,863 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-06 21:55:57,863 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-06 21:55:57,863 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-06 21:55:58,142 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 21:55:58,412 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 21:55:58,413 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 21:55:58,413 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 21:55:58,413 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 21:55:58,708 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 21:55:58,848 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.242 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 10)
2025-08-06 21:55:58,851 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.241, confidence=1.000, news_count=10
2025-08-06 21:55:58,851 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-06 21:55:58,863 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-06 21:55:58,863 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-06 21:55:59,242 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-06 21:55:59,245 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-06 21:55:59,260 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=1.000, avg_surprise=0.073, volatility=0.000
2025-08-06 21:55:59,276 - src.models.lstm_predictor - INFO - Generated 49 historical features from 1255 data points
2025-08-06 21:55:59,276 - src.models.lstm_predictor - INFO - Using 22 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Volatility_5d', 'Vol_Ratio', 'Volume_Ratio', 'Price_Volume', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Overall_Sentiment', 'Confidence_Score', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 21:55:59,278 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Confidence_Score']
2025-08-06 21:55:59,279 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 21:55:59,279 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 21:55:59,279 - src.models.lstm_predictor - INFO - Target range - Min: -0.123369, Max: 0.123369
2025-08-06 21:55:59,279 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123369
2025-08-06 21:55:59,282 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 21) features, (1224,) targets
2025-08-06 21:55:59,350 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 21:55:59,351 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 21:55:59,351 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123369, Max: 0.123369
2025-08-06 21:55:59,351 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033986, Train std: 0.440073
2025-08-06 21:55:59,351 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044719, Val std: 0.381094
2025-08-06 21:55:59,351 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 21:55:59,351 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 21:55:59,351 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-06 21:55:59,503 - src.models.lstm_predictor - INFO - Complex model built: 1,282,753 parameters
2025-08-06 21:55:59,503 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-06 21:55:59,503 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 21 features
2025-08-06 21:55:59,503 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 22:02:27,689 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.1647 - model may be poor quality
2025-08-06 22:02:30,515 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.026) below minimum threshold (0.01)
2025-08-06 22:02:30,515 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 22:06:05,452 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 22:06:05,452 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 22:06:06,045 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 22:06:06,045 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 22:06:06,057 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 22:06:06,057 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 22:06:06,057 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 22:06:06,314 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 22:06:06,348 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-06 22:06:06,349 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-06 22:06:06,349 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-06 22:06:06,349 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-06 22:06:06,515 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 22:06:06,686 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 22:06:06,686 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 22:06:06,686 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 22:06:06,686 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 22:06:06,921 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 22:06:07,044 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.242 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 10)
2025-08-06 22:06:07,046 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.241, confidence=1.000, news_count=10
2025-08-06 22:06:07,046 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-06 22:06:07,049 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-06 22:06:07,049 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-06 22:06:07,401 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-06 22:06:07,404 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-06 22:06:07,419 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=1.000, avg_surprise=0.073, volatility=0.000
2025-08-06 22:06:07,439 - src.models.lstm_predictor - INFO - Generated 63 historical features from 1255 data points
2025-08-06 22:06:07,439 - src.models.lstm_predictor - INFO - Using 33 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Consistency', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Volatility_5d', 'Vol_Ratio', 'Vol_Persistence', 'Volume_Ratio', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Relative_Strength', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 22:06:07,444 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 22:06:07,444 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 22:06:07,444 - src.models.lstm_predictor - INFO - Target range - Min: -0.123370, Max: 0.123370
2025-08-06 22:06:07,444 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123370
2025-08-06 22:06:07,448 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 33) features, (1224,) targets
2025-08-06 22:06:07,518 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 22:06:07,518 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 22:06:07,518 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123370, Max: 0.123370
2025-08-06 22:06:07,518 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033985, Train std: 0.440073
2025-08-06 22:06:07,518 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044721, Val std: 0.381095
2025-08-06 22:06:07,518 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 22:06:07,518 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 22:06:07,519 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-06 22:06:07,671 - src.models.lstm_predictor - INFO - Complex model built: 1,295,041 parameters
2025-08-06 22:06:07,671 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-06 22:06:07,671 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 33 features
2025-08-06 22:06:07,671 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 22:12:39,930 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.3136 - model may be poor quality
2025-08-06 22:12:42,927 - src.models.lstm_predictor - ERROR - Model quality validation failed: Model overfitting detected: Val R² 0.011 vs Test R² -0.070
2025-08-06 22:12:42,928 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 22:15:31,952 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 22:15:31,952 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 22:15:32,620 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 22:15:32,621 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 22:15:32,631 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 22:15:32,632 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 22:15:32,632 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 22:15:32,856 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 22:15:32,905 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-06 22:15:32,905 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-06 22:15:32,905 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-06 22:15:32,905 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-06 22:15:33,088 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 22:15:33,285 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 22:15:33,286 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 22:15:33,286 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 22:15:33,286 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 22:15:33,647 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 22:15:33,781 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.242 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 10)
2025-08-06 22:15:33,785 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.241, confidence=1.000, news_count=10
2025-08-06 22:15:33,785 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-06 22:15:33,790 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-06 22:15:33,790 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-06 22:15:34,164 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-06 22:15:34,168 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-06 22:15:34,182 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=1.000, avg_surprise=0.073, volatility=0.000
2025-08-06 22:15:34,208 - src.models.lstm_predictor - INFO - Generated 91 historical features from 1255 data points
2025-08-06 22:15:34,208 - src.models.lstm_predictor - INFO - Using 56 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Consistency', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Volatility_5d', 'Vol_Ratio', 'Vol_Persistence', 'Volume_Ratio', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Relative_Strength', 'Fractal_Dimension', 'Jump_Intensity', 'Jump_Signal', 'Regime_Bull', 'Regime_Bear', 'Trend_1w', 'Trend_2w', 'Trend_Alignment', 'Vol_Innovation', 'Vol_Squared_Lag', 'Info_Ratio', 'Cross_Momentum', 'VWAP_Deviation', 'OFI_Proxy', 'OFI_MA', 'Noise_Ratio', 'Monday_Effect', 'Friday_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Vol_Term_Structure', 'Stress_Indicator', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 22:15:34,215 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 22:15:34,215 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 22:15:34,215 - src.models.lstm_predictor - INFO - Target range - Min: -0.123370, Max: 0.123370
2025-08-06 22:15:34,215 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123370
2025-08-06 22:15:34,220 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 56) features, (1224,) targets
2025-08-06 22:15:34,291 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 22:15:34,291 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 22:15:34,291 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123370, Max: 0.123370
2025-08-06 22:15:34,292 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033983, Train std: 0.440073
2025-08-06 22:15:34,292 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044722, Val std: 0.381094
2025-08-06 22:15:34,292 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 22:15:34,292 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 22:15:34,292 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-06 22:15:34,442 - src.models.lstm_predictor - INFO - Complex model built: 1,318,593 parameters
2025-08-06 22:15:34,442 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-06 22:15:34,443 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 56 features
2025-08-06 22:15:34,443 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 22:22:21,766 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.9978 - model may be poor quality
2025-08-06 22:22:24,890 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.064) below minimum threshold (0.01)
2025-08-06 22:22:24,890 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 22:36:00,645 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 22:36:00,646 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 22:36:01,346 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 22:36:01,347 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 22:36:01,358 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 22:36:01,359 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 22:36:01,359 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 22:36:01,580 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 22:36:01,604 - src.models.lstm_predictor - ERROR - Enhanced training failed: 'Jump_Signal'
2025-08-06 22:38:16,891 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 22:38:16,891 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 22:38:17,476 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 22:38:17,476 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 22:38:17,488 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 22:38:17,489 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 22:38:17,489 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 22:38:17,694 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 22:38:17,743 - src.models.lstm_predictor - ERROR - Enhanced training failed: 'Jump_Signal'
2025-08-06 22:40:12,187 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 22:40:12,188 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 22:40:12,910 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 22:40:12,910 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 22:40:12,921 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 22:40:12,922 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 22:40:12,922 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 22:40:13,197 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 22:40:13,249 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-06 22:40:13,249 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-06 22:40:13,249 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-06 22:40:13,249 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-06 22:40:13,400 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 22:40:13,659 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 22:40:13,659 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 22:40:13,659 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 22:40:13,659 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 22:40:13,904 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 22:40:14,041 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.242 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 10)
2025-08-06 22:40:14,045 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.241, confidence=1.000, news_count=10
2025-08-06 22:40:14,045 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-06 22:40:14,049 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-06 22:40:14,049 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-06 22:40:14,423 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-06 22:40:14,426 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-06 22:40:14,443 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=1.000, avg_surprise=0.073, volatility=0.000
2025-08-06 22:40:14,469 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-06 22:40:14,469 - src.models.lstm_predictor - INFO - Using 43 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Ratio', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Fractal_Efficiency', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Month_Effect', 'Quarter_Effect', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 22:40:14,474 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 22:40:14,474 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 22:40:14,474 - src.models.lstm_predictor - INFO - Target range - Min: -0.123370, Max: 0.123370
2025-08-06 22:40:14,474 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123370
2025-08-06 22:40:14,479 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 43) features, (1224,) targets
2025-08-06 22:40:14,546 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 22:40:14,547 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 22:40:14,547 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123370, Max: 0.123370
2025-08-06 22:40:14,548 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033985, Train std: 0.440073
2025-08-06 22:40:14,548 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044720, Val std: 0.381094
2025-08-06 22:40:14,548 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 22:40:14,548 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 22:40:14,548 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-06 22:40:14,693 - src.models.lstm_predictor - INFO - Complex model built: 1,305,281 parameters
2025-08-06 22:40:14,693 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-06 22:40:14,693 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 43 features
2025-08-06 22:40:14,693 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 22:52:27,109 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.4399 - model may be poor quality
2025-08-06 22:52:30,698 - src.models.lstm_predictor - ERROR - Model quality validation failed: Validation R² (-0.012) below minimum threshold (0.01)
2025-08-06 22:52:30,698 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-06 23:21:55,198 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 23:21:55,198 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 23:21:55,819 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 23:21:55,819 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 23:21:55,831 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 23:21:55,832 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 23:21:55,832 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 23:21:56,032 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 23:21:56,076 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-06 23:21:56,077 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-06 23:21:56,077 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-06 23:21:56,077 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-06 23:21:56,260 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 23:21:56,524 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 23:21:56,525 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 23:21:56,526 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 23:21:56,526 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 23:21:56,758 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 23:21:56,783 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.242 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 10)
2025-08-06 23:21:56,788 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.241, confidence=1.000, news_count=10
2025-08-06 23:21:56,788 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-06 23:21:56,794 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-06 23:21:56,794 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-06 23:21:57,276 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-06 23:21:57,277 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-06 23:21:57,283 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=1.000, avg_surprise=0.073, volatility=0.000
2025-08-06 23:21:57,300 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-06 23:21:57,301 - src.models.lstm_predictor - INFO - Using 43 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Ratio', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Fractal_Efficiency', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Month_Effect', 'Quarter_Effect', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 23:21:57,306 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 23:21:57,306 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 23:21:57,306 - src.models.lstm_predictor - INFO - Target range - Min: -0.123370, Max: 0.123370
2025-08-06 23:21:57,306 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123370
2025-08-06 23:21:57,311 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 43) features, (1224,) targets
2025-08-06 23:21:57,379 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 23:21:57,379 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 23:21:57,379 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123370, Max: 0.123370
2025-08-06 23:21:57,380 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033986, Train std: 0.440072
2025-08-06 23:21:57,380 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044719, Val std: 0.381094
2025-08-06 23:21:57,380 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 23:21:57,380 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 23:21:57,381 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-06 23:21:57,548 - src.models.lstm_predictor - INFO - Complex model built: 1,305,281 parameters
2025-08-06 23:21:57,548 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-06 23:21:57,548 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 43 features
2025-08-06 23:21:57,548 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 23:28:38,193 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.2159 - model may be poor quality
2025-08-06 23:28:41,231 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 6/7 checks
✓ Val direction accuracy: 0.596
✗ Test direction accuracy: 0.465 < 0.52
✓ Val IC: -0.1638
✓ Test IC: 0.0484
✓ Val R²: -0.0999
✓ Test R²: -0.0330
✓ No severe overfitting
2025-08-06 23:28:41,365 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-06 23:28:41,365 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Poor ❌
2025-08-06 23:53:13,246 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-06 23:53:13,247 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_lstm_model.keras
2025-08-06 23:53:13,249 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_scaler.pkl
2025-08-06 23:53:13,250 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_feature_scaler.pkl
2025-08-06 23:53:13,289 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_metrics.json
2025-08-06 23:53:13,289 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-06 23:53:13,915 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-06 23:53:13,915 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-06 23:53:13,927 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-06 23:53:13,928 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-06 23:53:13,928 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-06 23:53:14,136 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-06 23:53:14,180 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-06 23:53:14,180 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-06 23:53:14,180 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-06 23:53:14,180 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-06 23:53:14,381 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-06 23:53:14,588 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-06 23:53:14,588 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for AAPL
2025-08-06 23:53:14,588 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-06 23:53:14,588 - src.analysis.sentiment - INFO - Trying alternative news sources for AAPL
2025-08-06 23:53:14,824 - src.analysis.sentiment - INFO - yfinance returned 10 news items for AAPL
2025-08-06 23:53:14,855 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.242 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 10)
2025-08-06 23:53:14,858 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.241, confidence=1.000, news_count=10
2025-08-06 23:53:14,858 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-06 23:53:14,863 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-06 23:53:14,863 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-06 23:53:15,358 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-06 23:53:15,361 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-06 23:53:15,374 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=1.000, avg_surprise=0.073, volatility=0.000
2025-08-06 23:53:15,400 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-06 23:53:15,400 - src.models.lstm_predictor - INFO - Using 43 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Ratio', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Fractal_Efficiency', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Month_Effect', 'Quarter_Effect', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume']
2025-08-06 23:53:15,404 - src.models.lstm_predictor - INFO - SIMPLIFIED target engineering: 15-day returns
2025-08-06 23:53:15,404 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009102, Std: 0.061980
2025-08-06 23:53:15,404 - src.models.lstm_predictor - INFO - Target range - Min: -0.123370, Max: 0.123370
2025-08-06 23:53:15,404 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.123370
2025-08-06 23:53:15,408 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 43) features, (1224,) targets
2025-08-06 23:53:15,477 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-06 23:53:15,478 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010110, Std: 0.062171
2025-08-06 23:53:15,478 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.123370, Max: 0.123370
2025-08-06 23:53:15,478 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.033985, Train std: 0.440073
2025-08-06 23:53:15,478 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.044721, Val std: 0.381094
2025-08-06 23:53:15,478 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-06 23:53:15,478 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010110, Train std: 0.062171
2025-08-06 23:53:15,478 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-06 23:53:15,635 - src.models.lstm_predictor - INFO - Complex model built: 1,308,503 parameters
2025-08-06 23:53:15,635 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-06 23:53:15,635 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 43 features
2025-08-06 23:53:15,635 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-06 23:57:49,832 - src.models.lstm_predictor - WARNING - High validation loss detected: 7.3623 - model may be poor quality
2025-08-06 23:57:52,756 - src.models.lstm_predictor - ERROR - Model quality validation failed: Financial metrics failed: 2/7 checks
✗ Val direction accuracy: 0.415 < 0.52
✗ Test direction accuracy: 0.422 < 0.52
✗ Val IC: -0.0043 < 0.02
✓ Test IC: -0.1121
✗ Val R²: -0.5179 < -0.1
✗ Test R²: -0.3416 < -0.1
✓ No severe overfitting
2025-08-06 23:57:52,756 - src.models.lstm_predictor - INFO - Cleaning up poor quality model files...
2025-08-07 00:03:30,895 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-07 00:03:30,895 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-07 00:03:31,552 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-07 00:03:31,552 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-07 00:03:31,562 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-07 00:03:31,562 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-07 00:03:31,562 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-07 00:03:31,774 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-07 00:03:31,802 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-07 00:03:31,802 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-07 00:03:31,802 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-07 00:03:31,802 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 00:03:32,006 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-07 00:03:32,432 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 00:03:32,432 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 00:03:32,435 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.304 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 50)
2025-08-07 00:03:32,441 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.303, confidence=1.000, news_count=50
2025-08-07 00:03:32,441 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 00:03:32,448 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-07 00:03:32,448 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-07 00:03:32,637 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 19 earnings events
2025-08-07 00:03:32,640 - src.models.lstm_predictor - INFO - Found 19 earnings events for comprehensive analysis
2025-08-07 00:03:32,654 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.789, avg_surprise=0.086, volatility=0.109
2025-08-07 00:03:32,682 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-07 00:03:32,682 - src.models.lstm_predictor - INFO - Using 46 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Ratio', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Fractal_Efficiency', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume', 'Earnings_Beat_History', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend', 'Month_Effect', 'Quarter_Effect']
2025-08-07 00:03:32,687 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['News_Volume', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend']
2025-08-07 00:03:32,690 - src.models.lstm_predictor - INFO - ENHANCED target engineering: 15-day movement prediction
2025-08-07 00:03:32,690 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009203, Std: 0.063157
2025-08-07 00:03:32,690 - src.models.lstm_predictor - INFO - Target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:03:32,690 - src.models.lstm_predictor - INFO - 98th percentile used for clipping: 0.139623
2025-08-07 00:03:32,695 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 43) features, (1224,) targets
2025-08-07 00:03:32,765 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-07 00:03:32,766 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010287, Std: 0.063084
2025-08-07 00:03:32,766 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:03:32,767 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.032824, Train std: 0.445722
2025-08-07 00:03:32,767 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.047468, Val std: 0.386622
2025-08-07 00:03:32,767 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-07 00:03:32,767 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010287, Train std: 0.063084
2025-08-07 00:03:32,767 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-07 00:03:32,935 - src.models.lstm_predictor - INFO - Complex model built: 1,308,503 parameters
2025-08-07 00:03:32,935 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-07 00:03:32,935 - src.models.lstm_predictor - INFO - Optimizer: Adam with lr=0.000375, clipnorm=1.0, amsgrad=True
2025-08-07 00:03:32,935 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 43 features
2025-08-07 00:03:32,935 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-07 00:07:46,522 - src.models.lstm_predictor - WARNING - High validation loss detected: 5.0193 - model may be poor quality
2025-08-07 00:07:49,580 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 6/7 checks
✓ Val direction accuracy: 0.546
✗ Test direction accuracy: 0.389 < 0.51
✓ Val IC: -0.0755
✓ Test IC: 0.0312
✓ Val R²: -0.1926
✓ Test R²: -0.0242
✓ No severe overfitting
2025-08-07 00:07:49,695 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-07 00:07:49,695 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Poor ❌
2025-08-07 00:14:26,416 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-07 00:14:26,419 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_lstm_model.keras
2025-08-07 00:14:26,420 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_scaler.pkl
2025-08-07 00:14:26,421 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_feature_scaler.pkl
2025-08-07 00:14:26,430 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_metrics.json
2025-08-07 00:14:26,430 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-07 00:14:27,045 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-07 00:14:27,045 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-07 00:14:27,057 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-07 00:14:27,058 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-07 00:14:27,058 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-07 00:14:27,278 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-07 00:14:27,320 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-07 00:14:27,320 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-07 00:14:27,320 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-07 00:14:27,320 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 00:14:27,493 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-07 00:14:27,870 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 00:14:27,870 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 00:14:27,871 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.304 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 50)
2025-08-07 00:14:27,874 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.303, confidence=1.000, news_count=50
2025-08-07 00:14:27,874 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 00:14:27,879 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-07 00:14:27,879 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-07 00:14:28,037 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 19 earnings events
2025-08-07 00:14:28,039 - src.models.lstm_predictor - INFO - Found 19 earnings events for comprehensive analysis
2025-08-07 00:14:28,047 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.789, avg_surprise=0.086, volatility=0.109
2025-08-07 00:14:28,067 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-07 00:14:28,067 - src.models.lstm_predictor - INFO - Using 46 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Ratio', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Fractal_Efficiency', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume', 'Earnings_Beat_History', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend', 'Month_Effect', 'Quarter_Effect']
2025-08-07 00:14:28,071 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['News_Volume', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend']
2025-08-07 00:14:28,073 - src.models.lstm_predictor - INFO - ENHANCED target engineering: 15-day movement prediction
2025-08-07 00:14:28,073 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009203, Std: 0.063157
2025-08-07 00:14:28,073 - src.models.lstm_predictor - INFO - Target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:14:28,073 - src.models.lstm_predictor - INFO - 98th percentile used for clipping: 0.139623
2025-08-07 00:14:28,078 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 43) features, (1224,) targets
2025-08-07 00:14:28,145 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-07 00:14:28,145 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010287, Std: 0.063084
2025-08-07 00:14:28,145 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:14:28,145 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.032823, Train std: 0.445722
2025-08-07 00:14:28,145 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.047469, Val std: 0.386622
2025-08-07 00:14:28,145 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-07 00:14:28,145 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010287, Train std: 0.063084
2025-08-07 00:14:28,146 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-07 00:14:28,306 - src.models.lstm_predictor - INFO - Complex model built: 1,308,503 parameters
2025-08-07 00:14:28,306 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-07 00:14:28,306 - src.models.lstm_predictor - INFO - Optimizer: Adam with lr=0.000375, clipnorm=1.0, amsgrad=True
2025-08-07 00:14:28,306 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 43 features
2025-08-07 00:14:28,306 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-07 00:16:43,880 - src.models.lstm_predictor - WARNING - High validation loss detected: 6.9857 - model may be poor quality
2025-08-07 00:16:46,714 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 4/7 checks
✗ Val direction accuracy: 0.503 < 0.51
✗ Test direction accuracy: 0.497 < 0.51
✓ Val IC: -0.1120
✓ Test IC: -0.0261
✗ Val R²: -0.3248 < -0.2
✓ Test R²: -0.1754
✓ No severe overfitting
2025-08-07 00:16:46,829 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-07 00:16:46,829 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Poor ❌
2025-08-07 00:19:38,789 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-07 00:19:38,791 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_lstm_model.keras
2025-08-07 00:19:38,792 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_scaler.pkl
2025-08-07 00:19:38,793 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_feature_scaler.pkl
2025-08-07 00:19:38,809 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_metrics.json
2025-08-07 00:19:38,809 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-07 00:19:39,410 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-07 00:19:39,410 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-07 00:19:39,422 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-07 00:19:39,423 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-07 00:19:39,423 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-07 00:19:39,635 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-07 00:19:39,659 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-07 00:19:39,659 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-07 00:19:39,659 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-07 00:19:39,659 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 00:19:39,831 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-07 00:19:40,140 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 00:19:40,141 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 00:19:40,144 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.304 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 50)
2025-08-07 00:19:40,151 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.303, confidence=1.000, news_count=50
2025-08-07 00:19:40,151 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 00:19:40,162 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-07 00:19:40,162 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-07 00:19:40,338 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 19 earnings events
2025-08-07 00:19:40,339 - src.models.lstm_predictor - INFO - Found 19 earnings events for comprehensive analysis
2025-08-07 00:19:40,344 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.789, avg_surprise=0.086, volatility=0.109
2025-08-07 00:19:40,358 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-07 00:19:40,358 - src.models.lstm_predictor - INFO - Using 46 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Ratio', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Fractal_Efficiency', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume', 'Earnings_Beat_History', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend', 'Month_Effect', 'Quarter_Effect']
2025-08-07 00:19:40,362 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['News_Volume', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend']
2025-08-07 00:19:40,364 - src.models.lstm_predictor - INFO - ENHANCED target engineering: 15-day movement prediction
2025-08-07 00:19:40,364 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009203, Std: 0.063157
2025-08-07 00:19:40,364 - src.models.lstm_predictor - INFO - Target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:19:40,364 - src.models.lstm_predictor - INFO - 98th percentile used for clipping: 0.139623
2025-08-07 00:19:40,368 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 43) features, (1224,) targets
2025-08-07 00:19:40,441 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-07 00:19:40,442 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010287, Std: 0.063084
2025-08-07 00:19:40,442 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:19:40,442 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.032824, Train std: 0.445721
2025-08-07 00:19:40,442 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.047468, Val std: 0.386621
2025-08-07 00:19:40,442 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-07 00:19:40,442 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010287, Train std: 0.063084
2025-08-07 00:19:40,442 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and multi-layer architecture
2025-08-07 00:19:40,603 - src.models.lstm_predictor - INFO - Complex model built: 1,308,503 parameters
2025-08-07 00:19:40,603 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM layers + 2 attention layers + 3 dense layers
2025-08-07 00:19:40,603 - src.models.lstm_predictor - INFO - Optimizer: Adam with lr=0.000375, clipnorm=1.0, amsgrad=True
2025-08-07 00:19:40,603 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 43 features
2025-08-07 00:19:40,603 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-07 00:20:33,996 - src.models.lstm_predictor - WARNING - High validation loss detected: 71.2794 - model may be poor quality
2025-08-07 00:20:37,444 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 4/7 checks
✓ Val direction accuracy: 0.672
✗ Test direction accuracy: 0.373 < 0.51
✓ Val IC: 0.2357
✓ Test IC: -0.1586
✗ Val R²: -3.7106 < -0.2
✗ Test R²: -2.6539 < -0.2
✓ No severe overfitting
2025-08-07 00:20:37,610 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-07 00:20:37,610 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Poor ❌
2025-08-07 00:30:06,626 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-07 00:30:06,628 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_lstm_model.keras
2025-08-07 00:30:06,629 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_scaler.pkl
2025-08-07 00:30:06,629 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_feature_scaler.pkl
2025-08-07 00:30:06,639 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_metrics.json
2025-08-07 00:30:06,639 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-07 00:30:07,372 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-07 00:30:07,372 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-07 00:30:07,386 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-07 00:30:07,387 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-07 00:30:07,387 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-07 00:30:07,604 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-07 00:30:07,635 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-07 00:30:07,635 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-07 00:30:07,635 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-07 00:30:07,635 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 00:30:07,782 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-07 00:30:08,140 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 00:30:08,140 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 00:30:08,143 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.304 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 50)
2025-08-07 00:30:08,148 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.303, confidence=1.000, news_count=50
2025-08-07 00:30:08,148 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 00:30:08,156 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-07 00:30:08,156 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-07 00:30:08,318 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 19 earnings events
2025-08-07 00:30:08,323 - src.models.lstm_predictor - INFO - Found 19 earnings events for comprehensive analysis
2025-08-07 00:30:08,338 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.789, avg_surprise=0.086, volatility=0.109
2025-08-07 00:30:08,363 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-07 00:30:08,363 - src.models.lstm_predictor - INFO - Using 46 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Ratio', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Fractal_Efficiency', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Price_Acceleration', 'Overall_Sentiment', 'Bullish_Ratio', 'Bearish_Ratio', 'Sentiment_Change', 'Sentiment_Price_Divergence', 'News_Volume', 'Earnings_Beat_History', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend', 'Month_Effect', 'Quarter_Effect']
2025-08-07 00:30:08,367 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['News_Volume', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend']
2025-08-07 00:30:08,369 - src.models.lstm_predictor - INFO - ENHANCED target engineering: 15-day movement prediction
2025-08-07 00:30:08,369 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.009203, Std: 0.063157
2025-08-07 00:30:08,369 - src.models.lstm_predictor - INFO - Target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:30:08,369 - src.models.lstm_predictor - INFO - 98th percentile used for clipping: 0.139623
2025-08-07 00:30:08,373 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 43) features, (1224,) targets
2025-08-07 00:30:08,443 - src.models.lstm_predictor - INFO - Using RobustScaler for target variable (better for financial data)
2025-08-07 00:30:08,443 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.010287, Std: 0.063084
2025-08-07 00:30:08,443 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.139623, Max: 0.139623
2025-08-07 00:30:08,444 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.032823, Train std: 0.445721
2025-08-07 00:30:08,444 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.047469, Val std: 0.386621
2025-08-07 00:30:08,444 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-07 00:30:08,444 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.010287, Train std: 0.063084
2025-08-07 00:30:08,444 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and ENHANCED anti-overfitting
2025-08-07 00:30:08,592 - src.models.lstm_predictor - INFO - REGULARIZED complex model built: 600,311 parameters
2025-08-07 00:30:08,592 - src.models.lstm_predictor - INFO - Enhanced Anti-Overfitting Architecture: Progressive regularization + reduced capacity
2025-08-07 00:30:08,592 - src.models.lstm_predictor - INFO - Optimizer: Adam with lr=0.000250, clipnorm=0.5, weight_decay=0.01
2025-08-07 00:30:08,592 - src.models.lstm_predictor - INFO - Features: L1/L2 regularization, progressive dropout, layer normalization, noise injection
2025-08-07 00:30:08,592 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 43 features
2025-08-07 00:30:08,592 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-07 00:32:57,124 - src.models.lstm_predictor - WARNING - High validation loss detected: 185.2166 - model may be poor quality
2025-08-07 00:32:59,096 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 5/7 checks
✓ Val direction accuracy: 0.596
✗ Test direction accuracy: 0.465 < 0.51
✓ Val IC: 0.1778
✓ Test IC: -0.1125
✓ Val R²: 0.0217
✓ Test R²: -0.1632
✗ Overfitting: Val R² 0.022 vs Test R² -0.163
2025-08-07 00:32:59,184 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-07 00:32:59,185 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Fair 👌
2025-08-07 00:37:29,191 - src.models.lstm_predictor - ERROR - Error loading enhanced model for AAPL: Could not locate function 'directional_loss'. Make sure custom classes are decorated with `@keras.saving.register_keras_serializable()`. Full object config: {'module': 'builtins', 'class_name': 'function', 'config': 'directional_loss', 'registered_name': 'function'}
2025-08-07 00:39:00,153 - src.models.lstm_predictor - INFO - Loaded enhanced model for AAPL
2025-08-07 00:52:17,733 - src.models.lstm_predictor - INFO - Starting enhanced training for AAPL
2025-08-07 00:52:17,735 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_lstm_model.keras
2025-08-07 00:52:17,735 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_scaler.pkl
2025-08-07 00:52:17,736 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_feature_scaler.pkl
2025-08-07 00:52:17,739 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/AAPL/AAPL_metrics.json
2025-08-07 00:52:17,739 - src.data.collector - INFO - Fetching fresh data for AAPL (5y)
2025-08-07 00:52:18,346 - src.data.collector - INFO - Running data validation pipeline for AAPL
2025-08-07 00:52:18,346 - src.data.validator - INFO - Starting validation for AAPL with 1255 rows
2025-08-07 00:52:18,356 - src.data.validator - INFO - Validation complete for AAPL: 1255 clean rows
2025-08-07 00:52:18,357 - src.data.validator - INFO - Pipeline complete for AAPL: 1255 -> 1255 rows
2025-08-07 00:52:18,357 - src.data.collector - INFO - Data pipeline: 1255 -> 1255 rows
2025-08-07 00:52:18,569 - src.data.collector - INFO - Successfully fetched data for AAPL
2025-08-07 00:52:18,615 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-07 00:52:18,615 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 5.0 years of data
2025-08-07 00:52:18,615 - src.analysis.sentiment - INFO - Analyzing sentiment for AAPL over 1825 days (5y)
2025-08-07 00:52:18,615 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 00:52:18,787 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for AAPL
2025-08-07 00:52:19,198 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 00:52:19,198 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 00:52:19,201 - src.analysis.sentiment - INFO - Historical sentiment for AAPL: 0.303 (trend: 0.955, momentum: -0.060, confidence: 1.000, news: 50)
2025-08-07 00:52:19,208 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.301, confidence=1.000, news_count=50
2025-08-07 00:52:19,208 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 00:52:19,217 - src.models.lstm_predictor - INFO - Requesting 19 earnings periods for 5.0 years of data
2025-08-07 00:52:19,217 - src.analysis.fundamentals - INFO - Fetching 19 earnings periods for AAPL
2025-08-07 00:52:19,371 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 19 earnings events
2025-08-07 00:52:19,373 - src.models.lstm_predictor - INFO - Found 19 earnings events for comprehensive analysis
2025-08-07 00:52:19,385 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.789, avg_surprise=0.086, volatility=0.109
2025-08-07 00:52:19,410 - src.models.lstm_predictor - INFO - Generated 92 historical features from 1255 data points
2025-08-07 00:52:19,410 - src.models.lstm_predictor - INFO - Using 34 features for training: ['Momentum_1d', 'Momentum_5d', 'Momentum_Strength', 'Momentum_Quality', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Volatility_5d', 'Vol_Regime', 'Vol_Breakout', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Volume_Price_Trend', 'Volume_Breakout', 'Sharpe_5d', 'Sharpe_20d', 'Fractal_Efficiency', 'Jump_Score', 'Bull_Regime', 'Bear_Regime', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Price_Acceleration', 'Overall_Sentiment', 'Bullish_Ratio', 'Sentiment_Change', 'Earnings_Beat_History', 'Earnings_Surprise_Avg', 'Recent_Earnings_Trend', 'Month_Effect', 'Quarter_Effect']
2025-08-07 00:52:19,413 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Earnings_Surprise_Avg', 'Recent_Earnings_Trend']
2025-08-07 00:52:19,414 - src.models.lstm_predictor - INFO - ROBUST target engineering: 1-day movement prediction
2025-08-07 00:52:19,414 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.000630, Std: 0.017534
2025-08-07 00:52:19,414 - src.models.lstm_predictor - INFO - Target range - Min: -0.057482, Max: 0.057482
2025-08-07 00:52:19,414 - src.models.lstm_predictor - INFO - 99th percentile used for clipping: 0.057482
2025-08-07 00:52:19,417 - src.models.lstm_predictor - INFO - Prepared training data: (1224, 30, 32) features, (1224,) targets
2025-08-07 00:52:19,483 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 00:52:19,483 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.000703, Std: 0.017465
2025-08-07 00:52:19,483 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.057482, Max: 0.057482
2025-08-07 00:52:19,483 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: 0.000000, Train std: 1.000000
2025-08-07 00:52:19,483 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: 0.021623, Val std: 0.845834
2025-08-07 00:52:19,483 - src.models.lstm_predictor - INFO - Data splits - Train: 856, Val: 183, Test: 185
2025-08-07 00:52:19,484 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.000703, Train std: 0.017465
2025-08-07 00:52:19,484 - src.models.lstm_predictor - INFO - Building COMPLEX model with 256 LSTM units and BALANCED regularization
2025-08-07 00:52:19,615 - src.models.lstm_predictor - INFO - BALANCED complex model built: 589,601 parameters
2025-08-07 00:52:19,615 - src.models.lstm_predictor - INFO - Balanced Architecture: Moderate regularization allowing effective learning
2025-08-07 00:52:19,615 - src.models.lstm_predictor - INFO - Optimizer: Adam with lr=0.000500, clipnorm=1.0, weight_decay=0.001
2025-08-07 00:52:19,615 - src.models.lstm_predictor - INFO - Features: Balanced L1/L2, moderate dropout (0.1-0.35), layer normalization
2025-08-07 00:52:19,615 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 32 features
2025-08-07 00:52:19,615 - src.models.lstm_predictor - INFO - SIMPLIFIED model with conservative parameters for stability
2025-08-07 00:54:40,279 - src.models.lstm_predictor - WARNING - High validation loss detected: 10.6863 - model may be poor quality
2025-08-07 00:54:42,241 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 6/7 checks
✓ Val direction accuracy: 0.574
✓ Test direction accuracy: 0.557
✓ Val IC: 0.0394
✓ Test IC: 0.0441
✓ Val R²: -0.0013
✓ Test R²: -0.0097
✗ Overfitting: Val R² -0.001 vs Test R² -0.010
2025-08-07 00:54:42,319 - src.models.lstm_predictor - INFO - Metrics saved to data/models/AAPL/AAPL_metrics.json
2025-08-07 00:54:42,319 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Poor ❌
2025-08-07 01:18:08,953 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 01:18:08,954 - src.data.collector - INFO - Fetching fresh data for TSLA (10y)
2025-08-07 01:18:09,552 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 01:18:09,552 - src.data.validator - INFO - Starting validation for TSLA with 2514 rows
2025-08-07 01:18:09,564 - src.data.validator - INFO - Validation complete for TSLA: 2514 clean rows
2025-08-07 01:18:09,564 - src.data.validator - INFO - Pipeline complete for TSLA: 2514 -> 2514 rows
2025-08-07 01:18:09,565 - src.data.collector - INFO - Data pipeline: 2514 -> 2514 rows
2025-08-07 01:18:09,771 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 01:18:09,822 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year historical sentiment features...
2025-08-07 01:18:09,822 - src.models.lstm_predictor - INFO - Using 5y sentiment analysis for 10.0 years of data
2025-08-07 01:18:09,822 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 01:18:09,822 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 01:18:09,943 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 01:18:10,361 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 01:18:10,361 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 01:18:10,362 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.564 (trend: 1.000, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 01:18:10,366 - src.models.lstm_predictor - INFO - Added 5y sentiment features: avg_sentiment=0.561, confidence=1.000, news_count=50
2025-08-07 01:18:10,366 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 01:18:10,371 - src.models.lstm_predictor - INFO - Requesting 39 earnings periods for 10.0 years of data
2025-08-07 01:18:10,372 - src.analysis.fundamentals - INFO - Fetching 39 earnings periods for TSLA
2025-08-07 01:18:10,501 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 39 earnings events
2025-08-07 01:18:10,502 - src.models.lstm_predictor - INFO - Found 39 earnings events for comprehensive analysis
2025-08-07 01:18:10,517 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.231, avg_surprise=0.617, volatility=3.419
2025-08-07 01:18:10,536 - src.models.lstm_predictor - INFO - Generated 92 historical features from 2514 data points
2025-08-07 01:18:10,536 - src.models.lstm_predictor - INFO - Using 12 features for training: ['Momentum_1d', 'Momentum_5d', 'Volatility_5d', 'Vol_Regime', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Price_SMA20_Ratio', 'RSI_Normalized', 'MACD_Histogram', 'Returns_Lag1', 'Volume_Price_Trend', 'Overall_Sentiment']
2025-08-07 01:18:10,539 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 01:18:10,539 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.001197, Std: 0.036409
2025-08-07 01:18:10,539 - src.models.lstm_predictor - INFO - Target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:18:10,540 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.075498
2025-08-07 01:18:10,543 - src.models.lstm_predictor - INFO - Prepared training data: (2483, 30, 12) features, (2483,) targets
2025-08-07 01:18:10,658 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001704, Std: 0.035627
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.000000, Train std: 1.000000
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.084088, Val std: 0.993140
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - Data splits - Train: 1738, Val: 372, Test: 373
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001704, Train std: 0.035627
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - 🔧 SIMPLIFIED MODEL selected:
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO -    Reason: Features=12, Samples=1738, Data=2514
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO -    Strategy: Single LSTM + 2 Dense layers for optimal R² performance
2025-08-07 01:18:10,659 - src.models.lstm_predictor - INFO - Building SIMPLIFIED model optimized for R² performance
2025-08-07 01:18:10,747 - src.models.lstm_predictor - INFO - SIMPLIFIED model built: 22,361 parameters
2025-08-07 01:18:10,747 - src.models.lstm_predictor - INFO - Architecture: Single LSTM + 2 Dense layers, optimized for R² performance
2025-08-07 01:18:10,747 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 12 features
2025-08-07 01:18:10,747 - src.models.lstm_predictor - INFO - Total parameters: 22,361
2025-08-07 01:18:18,234 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.1091 - model may be poor quality
2025-08-07 01:18:18,680 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 5/7 checks
✗ Val direction accuracy: 0.503 < 0.51
✗ Test direction accuracy: 0.496 < 0.51
✓ Val IC: 0.0465
✓ Test IC: 0.0642
✓ Val R²: -0.0055
✓ Test R²: 0.0021
✓ No severe overfitting
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - Metrics saved to data/models/TSLA/TSLA_metrics.json
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - COMPREHENSIVE MODEL EVALUATION
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - 🎯 TRAINING PERFORMANCE:
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Training Time: 9.9s
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Epochs Trained: 16
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Model Parameters: 22,361
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Features Used: 12
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - 📊 R² SCORE ANALYSIS:
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Validation R²: -0.0055
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Test R²: 0.0021
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Overfitting Gap: 0.0076
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    R² Assessment: ⚠️ BELOW AVERAGE - Still within normal range
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - 💰 FINANCIAL PERFORMANCE:
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Validation Direction Accuracy: 50.3%
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Test Direction Accuracy: 49.6%
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Validation Information Coefficient: 0.0465
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Test Information Coefficient: 0.0642
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Direction Assessment: ❌ POOR - Below random performance
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - 📉 ERROR ANALYSIS:
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Validation RMSE: 0.0355
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Test RMSE: 0.0411
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Validation MAE: 0.0261
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Test MAE: 0.0307
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - 🔍 GENERALIZATION ANALYSIS:
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Training R²: 0.0034
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Overfitting Ratio: 2.60
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Generalization Assessment: ❌ POOR - Significant overfitting
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - 💼 TRADING VIABILITY:
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Trading Readiness: 👍 PROMISING - Worth further testing
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO -    Trading Score: 3/6
2025-08-07 01:18:18,837 - src.models.lstm_predictor - INFO - 🎯 RECOMMENDATIONS:
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Consider using more training data (5+ years)
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Try different feature combinations
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Experiment with different prediction horizons
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Focus on directional accuracy over magnitude
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Consider ensemble methods
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Review feature engineering
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Increase regularization
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Reduce model complexity
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO -    • Use more training data
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 01:18:18,838 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Fair 👌
2025-08-07 01:35:03,899 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 01:35:03,900 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/TSLA/TSLA_lstm_model.keras
2025-08-07 01:35:03,901 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/TSLA/TSLA_scaler.pkl
2025-08-07 01:35:03,902 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/TSLA/TSLA_feature_scaler.pkl
2025-08-07 01:35:04,009 - src.models.lstm_predictor - INFO - Removed existing model file: data/models/TSLA/TSLA_metrics.json
2025-08-07 01:35:04,009 - src.data.collector - INFO - Fetching fresh data for TSLA (10y)
2025-08-07 01:35:04,642 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 01:35:04,642 - src.data.validator - INFO - Starting validation for TSLA with 2514 rows
2025-08-07 01:35:04,666 - src.data.validator - INFO - Validation complete for TSLA: 2514 clean rows
2025-08-07 01:35:04,667 - src.data.validator - INFO - Pipeline complete for TSLA: 2514 -> 2514 rows
2025-08-07 01:35:04,667 - src.data.collector - INFO - Data pipeline: 2514 -> 2514 rows
2025-08-07 01:35:04,870 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 01:35:04,898 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 01:35:04,899 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 01:35:04,899 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 01:35:04,899 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 01:35:04,988 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 01:35:05,430 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 01:35:05,431 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 01:35:05,433 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.567 (trend: 1.000, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 01:35:05,458 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.561, confidence=1.000, news_count=50
2025-08-07 01:35:05,458 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 01:35:05,470 - src.models.lstm_predictor - INFO - Requesting 39 earnings periods for 10.0 years of data
2025-08-07 01:35:05,470 - src.analysis.fundamentals - INFO - Fetching 39 earnings periods for TSLA
2025-08-07 01:35:05,654 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 39 earnings events
2025-08-07 01:35:05,654 - src.models.lstm_predictor - INFO - Found 39 earnings events for comprehensive analysis
2025-08-07 01:35:05,665 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.231, avg_surprise=0.617, volatility=3.419
2025-08-07 01:35:05,683 - src.models.lstm_predictor - INFO - Generated 100 historical features from 2514 data points
2025-08-07 01:35:05,683 - src.models.lstm_predictor - INFO - Using 71 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Quality', 'Momentum_Strength', 'Momentum_Consistency', 'Volatility_5d', 'Volatility_20d', 'Vol_Regime', 'Vol_Ratio', 'Vol_Persistence', 'Vol_Breakout', 'HL_Volatility', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Returns_Lag3', 'Price_Acceleration', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'Overall_Sentiment', 'Sentiment_Change', 'Sentiment_Volatility', 'Sentiment_Price_Divergence', 'Sentiment_Momentum', 'Sentiment_Regime', 'Sentiment_Strength', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Fractal_Efficiency', 'Relative_Strength', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Stress_Indicator', 'Vol_Term_Structure', 'Month_Effect', 'Quarter_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 01:35:05,688 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Sentiment_Regime', 'Days_To_Earnings', 'Earnings_Beat_History']
2025-08-07 01:35:05,689 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 01:35:05,690 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.001197, Std: 0.036409
2025-08-07 01:35:05,690 - src.models.lstm_predictor - INFO - Target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:35:05,690 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.075498
2025-08-07 01:35:05,706 - src.models.lstm_predictor - INFO - Prepared training data: (2483, 30, 68) features, (2483,) targets
2025-08-07 01:35:05,881 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 01:35:05,881 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001704, Std: 0.035627
2025-08-07 01:35:05,881 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.000000, Train std: 1.000000
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.084088, Val std: 0.993140
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO - Data splits - Train: 1738, Val: 372, Test: 373
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001704, Train std: 0.035627
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO - 🔧 COMPLEX MODEL selected for MAXIMUM LEARNING:
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO -    Features=68, Samples=1738, Data=2514
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO -    Strategy: Multi-layer LSTM + attention for 80%+ accuracy target
2025-08-07 01:35:05,882 - src.models.lstm_predictor - INFO - Building ENHANCED COMPLEX model with 256 LSTM units for 80%+ accuracy
2025-08-07 01:35:06,116 - src.models.lstm_predictor - INFO - ENHANCED COMPLEX model built: 1,695,753 parameters
2025-08-07 01:35:06,116 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM + 2 Attention + 4 Dense layers for maximum learning
2025-08-07 01:35:06,116 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 68 features
2025-08-07 01:35:06,117 - src.models.lstm_predictor - INFO - Total parameters: 1,695,753
2025-08-07 01:35:06,117 - src.models.lstm_predictor - INFO - Starting INTENSIVE training for 80%+ accuracy target...
2025-08-07 01:47:33,883 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 01:47:34,885 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 01:47:34,886 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 01:47:34,886 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 01:47:34,886 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 01:47:34,887 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 01:47:34,887 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 01:47:34,887 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 01:47:34,887 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 01:47:34,887 - src.data.collector - INFO - Fetching fresh data for TSLA (10y)
2025-08-07 01:47:35,552 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 01:47:35,552 - src.data.validator - INFO - Starting validation for TSLA with 2514 rows
2025-08-07 01:47:35,564 - src.data.validator - INFO - Validation complete for TSLA: 2514 clean rows
2025-08-07 01:47:35,565 - src.data.validator - INFO - Pipeline complete for TSLA: 2514 -> 2514 rows
2025-08-07 01:47:35,565 - src.data.collector - INFO - Data pipeline: 2514 -> 2514 rows
2025-08-07 01:47:35,791 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 01:47:35,846 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 01:47:35,846 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 01:47:35,846 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 01:47:35,846 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 01:47:35,942 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 01:47:36,349 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 01:47:36,349 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 01:47:36,353 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.567 (trend: 1.000, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 01:47:36,370 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.561, confidence=1.000, news_count=50
2025-08-07 01:47:36,370 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 01:47:36,378 - src.models.lstm_predictor - INFO - Requesting 39 earnings periods for 10.0 years of data
2025-08-07 01:47:36,378 - src.analysis.fundamentals - INFO - Fetching 39 earnings periods for TSLA
2025-08-07 01:47:36,528 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 39 earnings events
2025-08-07 01:47:36,529 - src.models.lstm_predictor - INFO - Found 39 earnings events for comprehensive analysis
2025-08-07 01:47:36,545 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.231, avg_surprise=0.617, volatility=3.419
2025-08-07 01:47:36,568 - src.models.lstm_predictor - INFO - Generated 100 historical features from 2514 data points
2025-08-07 01:47:36,568 - src.models.lstm_predictor - INFO - Using 71 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Quality', 'Momentum_Strength', 'Momentum_Consistency', 'Volatility_5d', 'Volatility_20d', 'Vol_Regime', 'Vol_Ratio', 'Vol_Persistence', 'Vol_Breakout', 'HL_Volatility', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Returns_Lag3', 'Price_Acceleration', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'Overall_Sentiment', 'Sentiment_Change', 'Sentiment_Volatility', 'Sentiment_Price_Divergence', 'Sentiment_Momentum', 'Sentiment_Regime', 'Sentiment_Strength', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Fractal_Efficiency', 'Relative_Strength', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Stress_Indicator', 'Vol_Term_Structure', 'Month_Effect', 'Quarter_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 01:47:36,574 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Sentiment_Regime', 'Days_To_Earnings', 'Earnings_Beat_History']
2025-08-07 01:47:36,576 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 01:47:36,577 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.001197, Std: 0.036409
2025-08-07 01:47:36,577 - src.models.lstm_predictor - INFO - Target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:47:36,577 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.075498
2025-08-07 01:47:36,590 - src.models.lstm_predictor - INFO - Prepared training data: (2483, 30, 68) features, (2483,) targets
2025-08-07 01:47:36,730 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 01:47:36,730 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001704, Std: 0.035627
2025-08-07 01:47:36,730 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:47:36,730 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.000000, Train std: 1.000000
2025-08-07 01:47:36,730 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.084088, Val std: 0.993140
2025-08-07 01:47:36,731 - src.models.lstm_predictor - INFO - Data splits - Train: 1738, Val: 372, Test: 373
2025-08-07 01:47:36,731 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001704, Train std: 0.035627
2025-08-07 01:47:36,731 - src.models.lstm_predictor - INFO - 🔧 COMPLEX MODEL selected for MAXIMUM LEARNING:
2025-08-07 01:47:36,731 - src.models.lstm_predictor - INFO -    Features=68, Samples=1738, Data=2514
2025-08-07 01:47:36,731 - src.models.lstm_predictor - INFO -    Strategy: Multi-layer LSTM + attention for 80%+ accuracy target
2025-08-07 01:47:36,731 - src.models.lstm_predictor - INFO - Building ENHANCED COMPLEX model with 256 LSTM units for 80%+ accuracy
2025-08-07 01:47:36,896 - src.models.lstm_predictor - INFO - ENHANCED COMPLEX model built: 1,695,753 parameters
2025-08-07 01:47:36,896 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM + 2 Attention + 4 Dense layers for maximum learning
2025-08-07 01:47:36,896 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 68 features
2025-08-07 01:47:36,897 - src.models.lstm_predictor - INFO - Total parameters: 1,695,753
2025-08-07 01:47:36,897 - src.models.lstm_predictor - INFO - Starting SYSTEM-AWARE INTENSIVE training for 80%+ accuracy target...
2025-08-07 01:47:36,897 - src.models.lstm_predictor - INFO - Training configuration: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 01:47:36,897 - src.models.lstm_predictor - ERROR - Enhanced training failed: fit() got an unexpected keyword argument 'workers'
2025-08-07 01:48:03,297 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 01:48:04,302 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 01:48:04,303 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 01:48:04,303 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 01:48:04,303 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 01:48:04,303 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 01:48:04,303 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 01:48:04,303 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 01:48:04,304 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 01:48:04,304 - src.data.collector - INFO - Fetching fresh data for TSLA (10y)
2025-08-07 01:48:04,974 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 01:48:04,974 - src.data.validator - INFO - Starting validation for TSLA with 2514 rows
2025-08-07 01:48:04,992 - src.data.validator - INFO - Validation complete for TSLA: 2514 clean rows
2025-08-07 01:48:04,993 - src.data.validator - INFO - Pipeline complete for TSLA: 2514 -> 2514 rows
2025-08-07 01:48:04,993 - src.data.collector - INFO - Data pipeline: 2514 -> 2514 rows
2025-08-07 01:48:05,194 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 01:48:05,240 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 01:48:05,240 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 01:48:05,240 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 01:48:05,240 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 01:48:05,324 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 01:48:05,708 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 01:48:05,708 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 01:48:05,711 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.567 (trend: 1.000, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 01:48:05,725 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.561, confidence=1.000, news_count=50
2025-08-07 01:48:05,725 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 01:48:05,731 - src.models.lstm_predictor - INFO - Requesting 39 earnings periods for 10.0 years of data
2025-08-07 01:48:05,731 - src.analysis.fundamentals - INFO - Fetching 39 earnings periods for TSLA
2025-08-07 01:48:05,876 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 39 earnings events
2025-08-07 01:48:05,879 - src.models.lstm_predictor - INFO - Found 39 earnings events for comprehensive analysis
2025-08-07 01:48:05,901 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.231, avg_surprise=0.617, volatility=3.419
2025-08-07 01:48:05,932 - src.models.lstm_predictor - INFO - Generated 100 historical features from 2514 data points
2025-08-07 01:48:05,932 - src.models.lstm_predictor - INFO - Using 71 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Quality', 'Momentum_Strength', 'Momentum_Consistency', 'Volatility_5d', 'Volatility_20d', 'Vol_Regime', 'Vol_Ratio', 'Vol_Persistence', 'Vol_Breakout', 'HL_Volatility', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Returns_Lag3', 'Price_Acceleration', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'Overall_Sentiment', 'Sentiment_Change', 'Sentiment_Volatility', 'Sentiment_Price_Divergence', 'Sentiment_Momentum', 'Sentiment_Regime', 'Sentiment_Strength', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Fractal_Efficiency', 'Relative_Strength', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Stress_Indicator', 'Vol_Term_Structure', 'Month_Effect', 'Quarter_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 01:48:05,938 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Sentiment_Regime', 'Days_To_Earnings', 'Earnings_Beat_History']
2025-08-07 01:48:05,941 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 01:48:05,941 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.001197, Std: 0.036409
2025-08-07 01:48:05,941 - src.models.lstm_predictor - INFO - Target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:48:05,941 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.075498
2025-08-07 01:48:05,955 - src.models.lstm_predictor - INFO - Prepared training data: (2483, 30, 68) features, (2483,) targets
2025-08-07 01:48:06,106 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 01:48:06,106 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001704, Std: 0.035627
2025-08-07 01:48:06,106 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.150995, Max: 0.150995
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.000000, Train std: 1.000000
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.084088, Val std: 0.993140
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO - Data splits - Train: 1738, Val: 372, Test: 373
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001704, Train std: 0.035627
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO - 🔧 COMPLEX MODEL selected for MAXIMUM LEARNING:
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO -    Features=68, Samples=1738, Data=2514
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO -    Strategy: Multi-layer LSTM + attention for 80%+ accuracy target
2025-08-07 01:48:06,107 - src.models.lstm_predictor - INFO - Building ENHANCED COMPLEX model with 256 LSTM units for 80%+ accuracy
2025-08-07 01:48:06,266 - src.models.lstm_predictor - INFO - ENHANCED COMPLEX model built: 1,695,753 parameters
2025-08-07 01:48:06,266 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM + 2 Attention + 4 Dense layers for maximum learning
2025-08-07 01:48:06,266 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 68 features
2025-08-07 01:48:06,267 - src.models.lstm_predictor - INFO - Total parameters: 1,695,753
2025-08-07 01:48:06,267 - src.models.lstm_predictor - INFO - Starting SYSTEM-AWARE INTENSIVE training for 80%+ accuracy target...
2025-08-07 01:48:06,267 - src.models.lstm_predictor - INFO - Training configuration: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 02:07:41,368 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 02:07:42,373 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 02:07:42,374 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 02:07:42,374 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 02:07:42,374 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 02:07:42,374 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 02:07:42,374 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 02:07:42,374 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 02:09:01,333 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 02:09:02,339 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 02:09:02,339 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 02:09:02,340 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 02:09:02,340 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 02:09:02,340 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 02:09:02,340 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 02:09:02,340 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 02:09:02,340 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 02:09:02,341 - src.data.collector - INFO - Fetching fresh data for TSLA (2y)
2025-08-07 02:09:02,942 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 02:09:02,943 - src.data.validator - INFO - Starting validation for TSLA with 502 rows
2025-08-07 02:09:02,964 - src.data.validator - INFO - Validation complete for TSLA: 502 clean rows
2025-08-07 02:09:02,964 - src.data.validator - INFO - Pipeline complete for TSLA: 502 -> 502 rows
2025-08-07 02:09:02,965 - src.data.collector - INFO - Data pipeline: 502 -> 502 rows
2025-08-07 02:09:03,168 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 02:09:03,198 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 02:09:03,198 - src.models.lstm_predictor - INFO - Using 2y sentiment with 7 temporal periods
2025-08-07 02:09:03,198 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 730 days (2y)
2025-08-07 02:09:03,199 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 2y period
2025-08-07 02:09:03,275 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 02:09:03,747 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 02:09:03,748 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 02:09:03,751 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.430 (trend: 0.510, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 02:09:03,763 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=7, avg_sentiment=0.423, confidence=1.000, news_count=50
2025-08-07 02:09:03,763 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 02:09:03,780 - src.models.lstm_predictor - INFO - Requesting 8 earnings periods for 2.0 years of data
2025-08-07 02:09:03,780 - src.analysis.fundamentals - INFO - Fetching 8 earnings periods for TSLA
2025-08-07 02:09:03,932 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 8 earnings events
2025-08-07 02:09:03,935 - src.models.lstm_predictor - INFO - Found 8 earnings events for comprehensive analysis
2025-08-07 02:09:03,941 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=-0.750, avg_surprise=-0.069, volatility=0.150
2025-08-07 02:09:03,960 - src.models.lstm_predictor - INFO - Generated 100 historical features from 502 data points
2025-08-07 02:09:03,960 - src.models.lstm_predictor - INFO - Using 71 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Quality', 'Momentum_Strength', 'Momentum_Consistency', 'Volatility_5d', 'Volatility_20d', 'Vol_Regime', 'Vol_Ratio', 'Vol_Persistence', 'Vol_Breakout', 'HL_Volatility', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Returns_Lag3', 'Price_Acceleration', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'Overall_Sentiment', 'Sentiment_Change', 'Sentiment_Volatility', 'Sentiment_Price_Divergence', 'Sentiment_Momentum', 'Sentiment_Regime', 'Sentiment_Strength', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Fractal_Efficiency', 'Relative_Strength', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Stress_Indicator', 'Vol_Term_Structure', 'Month_Effect', 'Quarter_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 02:09:03,963 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Sentiment_Regime', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg']
2025-08-07 02:09:03,964 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 02:09:03,964 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.000320, Std: 0.038769
2025-08-07 02:09:03,964 - src.models.lstm_predictor - INFO - Target range - Min: -0.154628, Max: 0.154628
2025-08-07 02:09:03,964 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.077314
2025-08-07 02:09:03,966 - src.models.lstm_predictor - INFO - Prepared training data: (471, 30, 66) features, (471,) targets
2025-08-07 02:09:03,999 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 02:09:03,999 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001062, Std: 0.036616
2025-08-07 02:09:03,999 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.131643, Max: 0.154628
2025-08-07 02:09:03,999 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: 0.000000, Train std: 1.000000
2025-08-07 02:09:04,000 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.220465, Val std: 1.345337
2025-08-07 02:09:04,000 - src.models.lstm_predictor - INFO - Data splits - Train: 329, Val: 70, Test: 72
2025-08-07 02:09:04,000 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001062, Train std: 0.036616
2025-08-07 02:09:04,000 - src.models.lstm_predictor - INFO - 🔧 SIMPLIFIED MODEL selected:
2025-08-07 02:09:04,000 - src.models.lstm_predictor - INFO -    Reason: Limited samples=329
2025-08-07 02:09:04,000 - src.models.lstm_predictor - INFO -    Strategy: Single LSTM + 2 Dense layers
2025-08-07 02:09:04,000 - src.models.lstm_predictor - INFO - Building SIMPLIFIED model optimized for R² performance
2025-08-07 02:09:04,087 - src.models.lstm_predictor - INFO - SIMPLIFIED model built: 36,293 parameters
2025-08-07 02:09:04,088 - src.models.lstm_predictor - INFO - Architecture: Single LSTM + 2 Dense layers, optimized for R² performance
2025-08-07 02:09:04,088 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 66 features
2025-08-07 02:09:04,088 - src.models.lstm_predictor - INFO - Total parameters: 36,293
2025-08-07 02:09:04,088 - src.models.lstm_predictor - INFO - Starting SYSTEM-AWARE INTENSIVE training for 80%+ accuracy target...
2025-08-07 02:09:04,088 - src.models.lstm_predictor - INFO - Training configuration: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 02:09:27,404 - src.models.lstm_predictor - WARNING - High validation loss detected: 2.2763 - model may be poor quality
2025-08-07 02:09:27,773 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 7/7 checks
✓ Val direction accuracy: 0.571
✓ Test direction accuracy: 0.542
✓ Val IC: 0.0228
✓ Test IC: 0.1324
✓ Val R²: -0.0697
✓ Test R²: -0.0209
✓ No severe overfitting
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO - Metrics saved to data/models/TSLA/TSLA_metrics.json
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO - COMPREHENSIVE MODEL EVALUATION
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO - 🎯 TRAINING PERFORMANCE:
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO -    Training Time: 25.5s
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO -    Epochs Trained: 120
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO -    Model Parameters: 36,293
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO -    Features Used: 66
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO - 📊 R² SCORE ANALYSIS:
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO -    Validation R²: -0.0697
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO -    Test R²: -0.0209
2025-08-07 02:09:27,799 - src.models.lstm_predictor - INFO -    Overfitting Gap: 0.0488
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    R² Assessment: ⚠️ BELOW AVERAGE - Still within normal range
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO - 💰 FINANCIAL PERFORMANCE:
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Validation Direction Accuracy: 57.1%
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Test Direction Accuracy: 54.2%
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Validation Information Coefficient: 0.0228
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Test Information Coefficient: 0.1324
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Direction Assessment: 👍 GOOD - Above random performance
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO - 📉 ERROR ANALYSIS:
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Validation RMSE: 0.0509
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Test RMSE: 0.0383
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Validation MAE: 0.0389
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Test MAE: 0.0294
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO - 🔍 GENERALIZATION ANALYSIS:
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Training R²: 0.2800
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Overfitting Ratio: 1.25
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Generalization Assessment: ❌ POOR - Significant overfitting
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO - 💼 TRADING VIABILITY:
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Trading Readiness: 🎯 READY - Good for trading strategies
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    Trading Score: 5/6
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO - 🎯 RECOMMENDATIONS:
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    • Consider using more training data (5+ years)
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    • Try different feature combinations
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    • Experiment with different prediction horizons
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    • Increase regularization
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    • Reduce model complexity
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO -    • Use more training data
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 02:09:27,800 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Fair 👌
2025-08-07 02:09:30,873 - src.models.ensemble - INFO - Training ensemble models for TSLA
2025-08-07 02:09:30,873 - src.data.collector - INFO - Fetching fresh data for TSLA (2y)
2025-08-07 02:09:31,023 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 02:09:31,023 - src.data.validator - INFO - Starting validation for TSLA with 502 rows
2025-08-07 02:09:31,030 - src.data.validator - INFO - Validation complete for TSLA: 502 clean rows
2025-08-07 02:09:31,032 - src.data.validator - INFO - Pipeline complete for TSLA: 502 -> 502 rows
2025-08-07 02:09:31,032 - src.data.collector - INFO - Data pipeline: 502 -> 502 rows
2025-08-07 02:09:31,216 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 02:09:31,218 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 02:09:32,221 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 02:09:32,222 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 02:09:32,222 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 02:09:32,223 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 02:09:32,223 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 02:09:32,223 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 02:09:32,224 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 02:09:32,267 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 02:09:32,267 - src.models.lstm_predictor - INFO - Using 2y sentiment with 7 temporal periods
2025-08-07 02:09:32,267 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 730 days (2y)
2025-08-07 02:09:32,267 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 2y period
2025-08-07 02:09:32,396 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 02:09:32,614 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 02:09:32,615 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 02:09:32,618 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.430 (trend: 0.510, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 02:09:32,633 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=7, avg_sentiment=0.423, confidence=1.000, news_count=50
2025-08-07 02:09:32,634 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 02:09:32,634 - src.models.lstm_predictor - INFO - Requesting 8 earnings periods for 2.0 years of data
2025-08-07 02:09:32,634 - src.analysis.fundamentals - INFO - Fetching 8 earnings periods for TSLA
2025-08-07 02:09:32,843 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 8 earnings events
2025-08-07 02:09:32,844 - src.models.lstm_predictor - INFO - Found 8 earnings events for comprehensive analysis
2025-08-07 02:09:32,847 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=-0.750, avg_surprise=-0.069, volatility=0.150
2025-08-07 02:09:32,863 - src.models.lstm_predictor - INFO - Generated 100 historical features from 502 data points
2025-08-07 02:09:32,895 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 7 days (7d)
2025-08-07 02:09:32,895 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 02:09:33,203 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 02:09:33,203 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 02:09:37,058 - src.models.ensemble - INFO - Added 5 sentiment features
2025-08-07 02:09:37,058 - src.models.ensemble - INFO - Selected 26 features for ensemble models
2025-08-07 02:09:37,061 - src.models.ensemble - INFO - Training random_forest...
2025-08-07 02:09:37,218 - src.models.ensemble - INFO - random_forest - Test R²: -0.0026
2025-08-07 02:09:37,218 - src.models.ensemble - INFO - Training gradient_boosting...
2025-08-07 02:09:37,532 - src.models.ensemble - INFO - gradient_boosting - Test R²: -0.1929
2025-08-07 02:09:37,532 - src.models.ensemble - INFO - Training linear_regression...
2025-08-07 02:09:37,540 - src.models.ensemble - INFO - linear_regression - Test R²: -0.0028
2025-08-07 02:09:37,583 - src.models.ensemble - INFO - Ensemble models saved to data/models/TSLA/ensemble
2025-08-07 02:09:37,598 - src.models.ensemble - INFO - Ensemble training completed - Test R²: -0.0086
2025-08-07 02:13:59,489 - __main__ - ERROR - Cleanup failed: [Errno 1] Operation not permitted: 'data/models/TSLA'
2025-08-07 02:29:10,492 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 02:29:11,500 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 02:29:11,501 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 02:29:11,501 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 02:29:11,502 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 02:29:11,502 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 02:29:11,502 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 02:29:11,502 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 02:29:11,502 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 02:29:11,502 - src.data.collector - INFO - Fetching fresh data for TSLA (10y)
2025-08-07 02:29:12,154 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 02:29:12,154 - src.data.validator - INFO - Starting validation for TSLA with 2514 rows
2025-08-07 02:29:12,166 - src.data.validator - INFO - Validation complete for TSLA: 2514 clean rows
2025-08-07 02:29:12,167 - src.data.validator - INFO - Pipeline complete for TSLA: 2514 -> 2514 rows
2025-08-07 02:29:12,167 - src.data.collector - INFO - Data pipeline: 2514 -> 2514 rows
2025-08-07 02:29:12,399 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 02:29:12,453 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 02:29:12,453 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 02:29:12,453 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 02:29:12,453 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 02:29:12,555 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 02:29:12,940 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 02:29:12,940 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 02:29:12,942 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.568 (trend: 1.000, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 02:29:12,953 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.561, confidence=1.000, news_count=50
2025-08-07 02:29:12,953 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 02:29:12,959 - src.models.lstm_predictor - INFO - Requesting 39 earnings periods for 10.0 years of data
2025-08-07 02:29:12,959 - src.analysis.fundamentals - INFO - Fetching 39 earnings periods for TSLA
2025-08-07 02:29:13,109 - src.analysis.fundamentals - INFO - Alpha Vantage: Retrieved 39 earnings events
2025-08-07 02:29:13,110 - src.models.lstm_predictor - INFO - Found 39 earnings events for comprehensive analysis
2025-08-07 02:29:13,125 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=0.231, avg_surprise=0.617, volatility=3.419
2025-08-07 02:29:13,148 - src.models.lstm_predictor - INFO - Generated 100 historical features from 2514 data points
2025-08-07 02:29:13,148 - src.models.lstm_predictor - INFO - Using 71 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Quality', 'Momentum_Strength', 'Momentum_Consistency', 'Volatility_5d', 'Volatility_20d', 'Vol_Regime', 'Vol_Ratio', 'Vol_Persistence', 'Vol_Breakout', 'HL_Volatility', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Returns_Lag3', 'Price_Acceleration', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'Overall_Sentiment', 'Sentiment_Change', 'Sentiment_Volatility', 'Sentiment_Price_Divergence', 'Sentiment_Momentum', 'Sentiment_Regime', 'Sentiment_Strength', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Fractal_Efficiency', 'Relative_Strength', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Stress_Indicator', 'Vol_Term_Structure', 'Month_Effect', 'Quarter_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 02:29:13,153 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Sentiment_Regime', 'Days_To_Earnings', 'Earnings_Beat_History']
2025-08-07 02:29:13,155 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 02:29:13,155 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.001197, Std: 0.036409
2025-08-07 02:29:13,155 - src.models.lstm_predictor - INFO - Target range - Min: -0.150995, Max: 0.150995
2025-08-07 02:29:13,155 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.075498
2025-08-07 02:29:13,169 - src.models.lstm_predictor - INFO - Prepared training data: (2483, 30, 68) features, (2483,) targets
2025-08-07 02:29:13,325 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 02:29:13,325 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001704, Std: 0.035627
2025-08-07 02:29:13,325 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.150995, Max: 0.150995
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: -0.000000, Train std: 1.000000
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.084088, Val std: 0.993140
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO - Data splits - Train: 1738, Val: 372, Test: 373
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001704, Train std: 0.035627
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO - 🔧 COMPLEX MODEL selected for MAXIMUM LEARNING:
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO -    Features=68, Samples=1738, Data=2514
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO -    Strategy: Multi-layer LSTM + attention for 80%+ accuracy target
2025-08-07 02:29:13,326 - src.models.lstm_predictor - INFO - Building ENHANCED COMPLEX model with 256 LSTM units for 80%+ accuracy
2025-08-07 02:29:13,539 - src.models.lstm_predictor - INFO - ENHANCED COMPLEX model built: 1,695,753 parameters
2025-08-07 02:29:13,539 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM + 2 Attention + 4 Dense layers for maximum learning
2025-08-07 02:29:13,539 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 68 features
2025-08-07 02:29:13,539 - src.models.lstm_predictor - INFO - Total parameters: 1,695,753
2025-08-07 02:29:13,539 - src.models.lstm_predictor - INFO - Starting SYSTEM-AWARE INTENSIVE training for 80%+ accuracy target...
2025-08-07 02:29:13,539 - src.models.lstm_predictor - INFO - Training configuration: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 03:36:04,626 - src.models.lstm_predictor - WARNING - High validation loss detected: 1.1053 - model may be poor quality
2025-08-07 03:36:10,407 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 5/7 checks
✓ Val direction accuracy: 0.543
✗ Test direction accuracy: 0.466 < 0.51
✓ Val IC: 0.0755
✓ Test IC: -0.0211
✓ Val R²: 0.0018
✓ Test R²: -0.0097
✗ Overfitting: Val R² 0.002 vs Test R² -0.010
2025-08-07 03:36:10,529 - src.models.lstm_predictor - INFO - Metrics saved to data/models/TSLA/TSLA_metrics.json
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO - COMPREHENSIVE MODEL EVALUATION
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO - 🎯 TRAINING PERFORMANCE:
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO -    Training Time: 4019.0s
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO -    Epochs Trained: 88
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO -    Model Parameters: 1,695,753
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO -    Features Used: 68
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO - 📊 R² SCORE ANALYSIS:
2025-08-07 03:36:10,530 - src.models.lstm_predictor - INFO -    Validation R²: 0.0018
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Test R²: -0.0097
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Overfitting Gap: 0.0115
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    R² Assessment: ⚠️ BELOW AVERAGE - Still within normal range
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO - 💰 FINANCIAL PERFORMANCE:
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Validation Direction Accuracy: 54.3%
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Test Direction Accuracy: 46.6%
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Validation Information Coefficient: 0.0755
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Test Information Coefficient: -0.0211
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Direction Assessment: ❌ POOR - Below random performance
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO - 📉 ERROR ANALYSIS:
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Validation RMSE: 0.0354
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Test RMSE: 0.0414
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Validation MAE: 0.0261
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Test MAE: 0.0311
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO - 🔍 GENERALIZATION ANALYSIS:
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Training R²: 0.0154
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Overfitting Ratio: 0.89
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Generalization Assessment: ⚠️ MODERATE - Some overfitting
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO - 💼 TRADING VIABILITY:
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Trading Readiness: 👍 PROMISING - Worth further testing
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    Trading Score: 3/6
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO - 🎯 RECOMMENDATIONS:
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Consider using more training data (5+ years)
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Try different feature combinations
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Experiment with different prediction horizons
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Focus on directional accuracy over magnitude
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Consider ensemble methods
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Review feature engineering
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Increase regularization
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Reduce model complexity
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO -    • Use more training data
2025-08-07 03:36:10,531 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 03:36:10,532 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Fair 👌
2025-08-07 03:36:11,095 - src.models.ensemble - INFO - Training ensemble models for TSLA
2025-08-07 03:36:11,095 - src.data.collector - INFO - Fetching fresh data for TSLA (10y)
2025-08-07 03:36:11,429 - src.data.collector - INFO - Running data validation pipeline for TSLA
2025-08-07 03:36:11,429 - src.data.validator - INFO - Starting validation for TSLA with 2514 rows
2025-08-07 03:36:11,438 - src.data.validator - INFO - Validation complete for TSLA: 2514 clean rows
2025-08-07 03:36:11,439 - src.data.validator - INFO - Pipeline complete for TSLA: 2514 -> 2514 rows
2025-08-07 03:36:11,439 - src.data.collector - INFO - Data pipeline: 2514 -> 2514 rows
2025-08-07 03:36:11,664 - src.data.collector - INFO - Successfully fetched data for TSLA
2025-08-07 03:36:11,666 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 03:36:12,676 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 03:36:12,677 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 03:36:12,677 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 03:36:12,679 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 03:36:12,679 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 03:36:12,679 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 03:36:12,679 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 03:36:12,735 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 03:36:12,735 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 03:36:12,736 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 03:36:12,736 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 03:36:12,861 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 03:36:13,233 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['items', 'sentiment_score_definition', 'relevance_score_definition', 'feed']
2025-08-07 03:36:13,233 - src.analysis.sentiment - INFO - Found 50 news items
2025-08-07 03:36:13,236 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.568 (trend: 1.000, momentum: 0.566, confidence: 1.000, news: 50)
2025-08-07 03:36:13,254 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.561, confidence=1.000, news_count=50
2025-08-07 03:36:13,254 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 03:36:13,254 - src.models.lstm_predictor - INFO - Requesting 39 earnings periods for 10.0 years of data
2025-08-07 03:36:13,254 - src.analysis.fundamentals - INFO - Fetching 39 earnings periods for TSLA
2025-08-07 03:36:13,590 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-07 03:36:13,593 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-07 03:36:13,618 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=-1.000, avg_surprise=-0.085, volatility=0.000
2025-08-07 03:36:13,643 - src.models.lstm_predictor - INFO - Generated 100 historical features from 2514 data points
2025-08-07 03:36:13,801 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 7 days (7d)
2025-08-07 03:36:13,801 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 03:36:13,911 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-07 03:36:13,911 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for TSLA
2025-08-07 03:36:13,911 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-07 03:36:13,911 - src.analysis.sentiment - INFO - Trying alternative news sources for TSLA
2025-08-07 03:36:14,139 - src.analysis.sentiment - INFO - yfinance returned 10 news items for TSLA
2025-08-07 03:36:18,332 - src.models.ensemble - INFO - Added 5 sentiment features
2025-08-07 03:36:18,333 - src.models.ensemble - INFO - Selected 26 features for ensemble models
2025-08-07 03:36:18,339 - src.models.ensemble - INFO - Training random_forest...
2025-08-07 03:36:18,828 - src.models.ensemble - INFO - random_forest - Test R²: -0.0497
2025-08-07 03:36:18,828 - src.models.ensemble - INFO - Training gradient_boosting...
2025-08-07 03:36:20,549 - src.models.ensemble - INFO - gradient_boosting - Test R²: -0.1208
2025-08-07 03:36:20,549 - src.models.ensemble - INFO - Training linear_regression...
2025-08-07 03:36:20,559 - src.models.ensemble - INFO - linear_regression - Test R²: 0.0056
2025-08-07 03:36:20,660 - src.models.ensemble - INFO - Ensemble models saved to data/models/TSLA/ensemble
2025-08-07 03:36:20,699 - src.models.ensemble - INFO - Ensemble training completed - Test R²: -0.0184
2025-08-07 09:02:37,914 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 09:02:38,919 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 09:02:38,919 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 09:02:38,921 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 09:02:38,922 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 09:02:38,922 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 09:02:38,922 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 09:02:38,922 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 09:02:38,923 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 09:02:38,923 - src.data.collector - INFO - 🚀 MEGA DATA MODE: Fetching comprehensive data from ALL APIs for TSLA
2025-08-07 09:02:38,923 - src.data.collector - INFO - 🚀 MEGA DATA: Starting comprehensive data collection for TSLA
2025-08-07 09:02:39,534 - src.data.collector - INFO - 📊 Yahoo Finance: Retrieved 3800 days of base data
2025-08-07 09:02:39,731 - src.data.collector - INFO - Alpha Vantage API not yet implemented
2025-08-07 09:02:39,731 - src.data.collector - INFO - FMP API not yet implemented
2025-08-07 09:02:39,731 - src.data.collector - INFO - Finnhub API not yet implemented
2025-08-07 09:02:39,731 - src.data.collector - INFO - 🧠 Applying mega feature engineering...
2025-08-07 09:02:39,863 - src.data.collector - INFO - ✨ Enhanced with 31 total features
2025-08-07 09:02:39,863 - src.data.collector - INFO - 🔍 Running enhanced validation pipeline for mega data
2025-08-07 09:02:39,863 - src.data.validator - INFO - Starting validation for TSLA with 3800 rows
2025-08-07 09:02:39,883 - src.data.validator - INFO - Validation complete for TSLA: 3601 clean rows
2025-08-07 09:02:39,884 - src.data.validator - INFO - Pipeline complete for TSLA: 3800 -> 3601 rows
2025-08-07 09:02:39,884 - src.data.collector - WARNING - Mega data warnings: Handled 446 missing values, 0 remaining
2025-08-07 09:02:39,884 - src.data.collector - INFO - 📈 Mega data pipeline: 3800 -> 3601 rows
2025-08-07 09:02:39,884 - src.data.collector - INFO - ✅ MEGA DATA: Successfully collected comprehensive dataset with 3601 rows and 31 features
2025-08-07 09:02:39,922 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 09:02:39,922 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 09:02:39,922 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 09:02:39,922 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 09:02:40,016 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 09:02:40,213 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-07 09:02:40,213 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for TSLA
2025-08-07 09:02:40,213 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-07 09:02:40,213 - src.analysis.sentiment - INFO - Trying alternative news sources for TSLA
2025-08-07 09:02:40,531 - src.analysis.sentiment - INFO - yfinance returned 10 news items for TSLA
2025-08-07 09:02:40,640 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.518 (trend: 1.000, momentum: 0.566, confidence: 1.000, news: 10)
2025-08-07 09:02:40,647 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.512, confidence=1.000, news_count=10
2025-08-07 09:02:40,647 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 09:02:40,653 - src.models.lstm_predictor - INFO - Requesting 57 earnings periods for 14.3 years of data
2025-08-07 09:02:40,653 - src.analysis.fundamentals - INFO - Fetching 57 earnings periods for TSLA
2025-08-07 09:02:40,991 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-07 09:02:40,992 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-07 09:02:41,009 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=-1.000, avg_surprise=-0.085, volatility=0.000
2025-08-07 09:02:41,032 - src.models.lstm_predictor - INFO - Generated 124 historical features from 3601 data points
2025-08-07 09:02:41,032 - src.models.lstm_predictor - INFO - Using 71 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Quality', 'Momentum_Strength', 'Momentum_Consistency', 'Volatility_5d', 'Volatility_20d', 'Vol_Regime', 'Vol_Ratio', 'Vol_Persistence', 'Vol_Breakout', 'HL_Volatility', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Returns_Lag3', 'Price_Acceleration', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'Overall_Sentiment', 'Sentiment_Change', 'Sentiment_Volatility', 'Sentiment_Price_Divergence', 'Sentiment_Momentum', 'Sentiment_Regime', 'Sentiment_Strength', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Fractal_Efficiency', 'Relative_Strength', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Stress_Indicator', 'Vol_Term_Structure', 'Month_Effect', 'Quarter_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 09:02:41,038 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Sentiment_Regime', 'Days_To_Earnings', 'Earnings_Beat_History', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 09:02:41,040 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 09:02:41,041 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.001468, Std: 0.035185
2025-08-07 09:02:41,041 - src.models.lstm_predictor - INFO - Target range - Min: -0.146435, Max: 0.146435
2025-08-07 09:02:41,041 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.073217
2025-08-07 09:02:41,059 - src.models.lstm_predictor - INFO - Prepared training data: (3570, 30, 66) features, (3570,) targets
2025-08-07 09:02:41,267 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 09:02:41,267 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001961, Std: 0.034009
2025-08-07 09:02:41,267 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.146435, Max: 0.146435
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: 0.000000, Train std: 1.000000
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.053324, Val std: 1.107665
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO - Data splits - Train: 2499, Val: 535, Test: 536
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001961, Train std: 0.034009
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO - 🔧 COMPLEX MODEL selected for MAXIMUM LEARNING:
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO -    Features=66, Samples=2499, Data=3601
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO -    Strategy: Multi-layer LSTM + attention for 80%+ accuracy target
2025-08-07 09:02:41,268 - src.models.lstm_predictor - INFO - Building ENHANCED COMPLEX model with 256 LSTM units for 80%+ accuracy
2025-08-07 09:02:41,441 - src.models.lstm_predictor - INFO - ENHANCED COMPLEX model built: 1,693,701 parameters
2025-08-07 09:02:41,441 - src.models.lstm_predictor - INFO - Architecture: 3 LSTM + 2 Attention + 4 Dense layers for maximum learning
2025-08-07 09:02:41,441 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 66 features
2025-08-07 09:02:41,441 - src.models.lstm_predictor - INFO - Total parameters: 1,693,701
2025-08-07 09:02:41,441 - src.models.lstm_predictor - INFO - Starting SYSTEM-AWARE INTENSIVE training for 80%+ accuracy target...
2025-08-07 09:02:41,441 - src.models.lstm_predictor - INFO - Training configuration: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 17:51:01,422 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 17:51:02,427 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 17:51:02,427 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 17:51:02,427 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 17:51:02,428 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 17:51:02,428 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 17:51:02,428 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 17:51:02,428 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 17:51:02,428 - src.models.lstm_predictor - INFO - Starting enhanced training for TSLA
2025-08-07 17:51:02,429 - src.data.collector - INFO - 🚀 MEGA DATA MODE: Fetching comprehensive data from ALL APIs for TSLA
2025-08-07 17:51:02,429 - src.data.collector - INFO - 🚀 MEGA DATA: Starting comprehensive data collection for TSLA
2025-08-07 17:51:03,096 - src.data.collector - INFO - 📊 Yahoo Finance: Retrieved 3801 days of base data
2025-08-07 17:51:03,341 - src.data.collector - INFO - Alpha Vantage API not yet implemented
2025-08-07 17:51:03,341 - src.data.collector - INFO - FMP API not yet implemented
2025-08-07 17:51:03,341 - src.data.collector - INFO - Finnhub API not yet implemented
2025-08-07 17:51:03,341 - src.data.collector - INFO - 🧠 Applying mega feature engineering...
2025-08-07 17:51:03,444 - src.data.collector - INFO - ✨ Enhanced with 31 total features
2025-08-07 17:51:03,444 - src.data.collector - INFO - 🔍 Running enhanced validation pipeline for mega data
2025-08-07 17:51:03,444 - src.data.validator - INFO - Starting validation for TSLA with 3801 rows
2025-08-07 17:51:03,457 - src.data.validator - INFO - Validation complete for TSLA: 3602 clean rows
2025-08-07 17:51:03,458 - src.data.validator - INFO - Pipeline complete for TSLA: 3801 -> 3602 rows
2025-08-07 17:51:03,458 - src.data.collector - WARNING - Mega data warnings: Handled 446 missing values, 0 remaining
2025-08-07 17:51:03,459 - src.data.collector - INFO - 📈 Mega data pipeline: 3801 -> 3602 rows
2025-08-07 17:51:03,459 - src.data.collector - INFO - ✅ MEGA DATA: Successfully collected comprehensive dataset with 3602 rows and 31 features
2025-08-07 17:51:03,492 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 17:51:03,492 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 17:51:03,492 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 17:51:03,492 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 17:51:03,594 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 17:51:03,811 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-07 17:51:03,811 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for TSLA
2025-08-07 17:51:03,811 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-07 17:51:03,811 - src.analysis.sentiment - INFO - Trying alternative news sources for TSLA
2025-08-07 17:51:04,077 - src.analysis.sentiment - INFO - yfinance returned 10 news items for TSLA
2025-08-07 17:51:04,177 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.542 (trend: 1.000, momentum: 0.623, confidence: 1.000, news: 10)
2025-08-07 17:51:04,185 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.536, confidence=1.000, news_count=10
2025-08-07 17:51:04,185 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 17:51:04,192 - src.models.lstm_predictor - INFO - Requesting 57 earnings periods for 14.3 years of data
2025-08-07 17:51:04,193 - src.analysis.fundamentals - INFO - Fetching 57 earnings periods for TSLA
2025-08-07 17:51:04,526 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-07 17:51:04,527 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-07 17:51:04,543 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=-1.000, avg_surprise=-0.085, volatility=0.000
2025-08-07 17:51:04,565 - src.models.lstm_predictor - INFO - Generated 124 historical features from 3602 data points
2025-08-07 17:51:04,566 - src.models.lstm_predictor - INFO - Using 71 features for training: ['Momentum_1d', 'Momentum_3d', 'Momentum_5d', 'Momentum_Quality', 'Momentum_Strength', 'Momentum_Consistency', 'Volatility_5d', 'Volatility_20d', 'Vol_Regime', 'Vol_Ratio', 'Vol_Persistence', 'Vol_Breakout', 'HL_Volatility', 'Mean_Reversion_5d', 'Mean_Reversion_20d', 'Reversion_Divergence', 'Distance_From_SMA20', 'Mean_Reversion_Signal', 'Price_SMA5_Ratio', 'Price_SMA20_Ratio', 'SMA_Cross', 'RSI_Normalized', 'MACD_Histogram', 'BB_Position', 'Returns_Lag1', 'Returns_Lag2', 'Returns_Lag3', 'Price_Acceleration', 'Volume_Ratio', 'Volume_Price_Trend', 'Volume_Breakout', 'Price_Volume', 'VPT_Normalized', 'Price_Efficiency', 'Overall_Sentiment', 'Sentiment_Change', 'Sentiment_Volatility', 'Sentiment_Price_Divergence', 'Sentiment_Momentum', 'Sentiment_Regime', 'Sentiment_Strength', 'Trend_Persistence', 'Trend_Acceleration', 'Multi_Trend_Align', 'Fractal_Efficiency', 'Relative_Strength', 'Sharpe_5d', 'Sharpe_20d', 'Sharpe_Ratio', 'Jump_Score', 'Outlier_Signal', 'Bull_Regime', 'Bear_Regime', 'High_Vol_Regime', 'Stress_Indicator', 'Vol_Term_Structure', 'Month_Effect', 'Quarter_Effect', 'January_Effect', 'December_Effect', 'Quarter_End', 'Spread_Proxy', 'Spread_Anomaly', 'Price_Percentile_20d', 'Price_Percentile_50d', 'Days_To_Earnings', 'Earnings_Beat_History', 'EPS_Growth_Rate', 'Earnings_Surprise_Avg', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 17:51:04,574 - src.models.lstm_predictor - WARNING - Removing zero-variance features: ['Sentiment_Regime', 'Days_To_Earnings', 'Earnings_Beat_History', 'Earnings_Volatility', 'Recent_Earnings_Trend']
2025-08-07 17:51:04,577 - src.models.lstm_predictor - INFO - IMPROVED target engineering: Log returns for 1-day movement prediction
2025-08-07 17:51:04,577 - src.models.lstm_predictor - INFO - Target stats - Mean: 0.001469, Std: 0.035179
2025-08-07 17:51:04,577 - src.models.lstm_predictor - INFO - Target range - Min: -0.146387, Max: 0.146387
2025-08-07 17:51:04,577 - src.models.lstm_predictor - INFO - 95th percentile used for clipping: 0.073194
2025-08-07 17:51:04,597 - src.models.lstm_predictor - INFO - Prepared training data: (3571, 30, 66) features, (3571,) targets
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - Using StandardScaler for target variable (consistent with features)
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - Pre-scaling target stats - Mean: 0.001961, Std: 0.034007
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - Pre-scaling target range - Min: -0.146387, Max: 0.146387
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - Post-scaling target stats - Train mean: 0.000000, Train std: 1.000000
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - Post-scaling validation - Val mean: -0.053325, Val std: 1.107716
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - Data splits - Train: 2499, Val: 535, Test: 537
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - Target scaling - Train mean: 0.001961, Train std: 0.034007
2025-08-07 17:51:04,798 - src.models.lstm_predictor - INFO - 🔧 COMPLEX MODEL selected for MAXIMUM LEARNING:
2025-08-07 17:51:04,799 - src.models.lstm_predictor - INFO -    Features=66, Samples=2499, Data=3602
2025-08-07 17:51:04,799 - src.models.lstm_predictor - INFO -    Strategy: Multi-layer LSTM + attention for 80%+ accuracy target
2025-08-07 17:51:04,799 - src.models.lstm_predictor - INFO - Building PLATEAU-BREAKING COMPLEX model with 192 LSTM units
2025-08-07 17:51:04,799 - src.models.lstm_predictor - INFO - 🚀 Optimized architecture to break through 0.9 loss barrier
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - PLATEAU-BREAKING COMPLEX model built: 942,949 parameters
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - 🔥 Architecture optimized to break through 0.9 loss barrier
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - 🚀 Features: Residual connections, Swish activation, AMSGrad optimizer, Huber loss
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - Model architecture: 30 time steps, 66 features
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - Total parameters: 942,949
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - 🚀 Starting PLATEAU-BREAKING training optimized to break through 0.9 loss barrier...
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - 🔥 Enhanced with: Cyclical LR, Adaptive Loss, Residual Connections, AMSGrad
2025-08-07 17:51:04,980 - src.models.lstm_predictor - INFO - Training configuration: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 18:02:26,607 - src.models.lstm_predictor - WARNING - High validation loss detected: 0.6386 - model may be poor quality
2025-08-07 18:02:32,038 - src.models.lstm_predictor - INFO - Model passed quality validation: Financial metrics passed: 7/7 checks
✓ Val direction accuracy: 0.521
✓ Test direction accuracy: 0.533
✓ Val IC: 0.0666
✓ Test IC: 0.0754
✓ Val R²: -0.0231
✓ Test R²: -0.0178
✓ No severe overfitting
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - Metrics saved to data/models/TSLA/TSLA_metrics.json
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - COMPREHENSIVE MODEL EVALUATION
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - 🎯 TRAINING PERFORMANCE:
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Training Time: 689.7s
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Epochs Trained: 52
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Model Parameters: 942,949
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Features Used: 66
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - 📊 R² SCORE ANALYSIS:
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Validation R²: -0.0231
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Test R²: -0.0178
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Overfitting Gap: 0.0053
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    R² Assessment: ⚠️ BELOW AVERAGE - Still within normal range
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - 💰 FINANCIAL PERFORMANCE:
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Validation Direction Accuracy: 52.1%
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Test Direction Accuracy: 53.3%
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Validation Information Coefficient: 0.0666
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Test Information Coefficient: 0.0754
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Direction Assessment: 👍 GOOD - Above random performance
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - 📉 ERROR ANALYSIS:
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Validation RMSE: 0.0381
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Test RMSE: 0.0385
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Validation MAE: 0.0281
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Test MAE: 0.0284
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO - 🔍 GENERALIZATION ANALYSIS:
2025-08-07 18:02:32,123 - src.models.lstm_predictor - INFO -    Training R²: 0.0552
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    Overfitting Ratio: 1.42
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    Generalization Assessment: ❌ POOR - Significant overfitting
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO - 💼 TRADING VIABILITY:
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    Trading Readiness: 🎯 READY - Good for trading strategies
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    Trading Score: 5/6
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO - 🎯 RECOMMENDATIONS:
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    • Consider using more training data (5+ years)
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    • Try different feature combinations
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    • Experiment with different prediction horizons
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    • Increase regularization
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    • Reduce model complexity
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO -    • Use more training data
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO - ================================================================================
2025-08-07 18:02:32,124 - src.models.lstm_predictor - INFO - Enhanced training completed successfully - Quality: Fair 👌
2025-08-07 18:02:32,514 - src.models.ensemble - INFO - Training ensemble models for TSLA
2025-08-07 18:02:32,514 - src.data.collector - INFO - 🚀 MEGA DATA MODE: Fetching comprehensive data from ALL APIs for TSLA
2025-08-07 18:02:32,514 - src.data.collector - INFO - 🚀 MEGA DATA: Starting comprehensive data collection for TSLA
2025-08-07 18:02:32,861 - src.data.collector - INFO - 📊 Yahoo Finance: Retrieved 3801 days of base data
2025-08-07 18:02:33,094 - src.data.collector - INFO - Alpha Vantage API not yet implemented
2025-08-07 18:02:33,094 - src.data.collector - INFO - FMP API not yet implemented
2025-08-07 18:02:33,094 - src.data.collector - INFO - Finnhub API not yet implemented
2025-08-07 18:02:33,094 - src.data.collector - INFO - 🧠 Applying mega feature engineering...
2025-08-07 18:02:33,218 - src.data.collector - INFO - ✨ Enhanced with 31 total features
2025-08-07 18:02:33,218 - src.data.collector - INFO - 🔍 Running enhanced validation pipeline for mega data
2025-08-07 18:02:33,219 - src.data.validator - INFO - Starting validation for TSLA with 3801 rows
2025-08-07 18:02:33,229 - src.data.validator - INFO - Validation complete for TSLA: 3602 clean rows
2025-08-07 18:02:33,230 - src.data.validator - INFO - Pipeline complete for TSLA: 3801 -> 3602 rows
2025-08-07 18:02:33,230 - src.data.collector - WARNING - Mega data warnings: Handled 446 missing values, 0 remaining
2025-08-07 18:02:33,230 - src.data.collector - INFO - 📈 Mega data pipeline: 3801 -> 3602 rows
2025-08-07 18:02:33,230 - src.data.collector - INFO - ✅ MEGA DATA: Successfully collected comprehensive dataset with 3602 rows and 31 features
2025-08-07 18:02:33,230 - src.models.lstm_predictor - INFO - No GPU found, using CPU
2025-08-07 18:02:34,236 - src.models.lstm_predictor - INFO - System detected: laptop
2025-08-07 18:02:34,237 - src.models.lstm_predictor - INFO - GPU available: False
2025-08-07 18:02:34,237 - src.models.lstm_predictor - INFO - Thermal profile: balanced
2025-08-07 18:02:34,237 - src.models.lstm_predictor - INFO - Initialized Enhanced LSTM for TSLA
2025-08-07 18:02:34,238 - src.models.lstm_predictor - INFO - System: laptop (balanced thermal profile)
2025-08-07 18:02:34,238 - src.models.lstm_predictor - INFO - GPU Available: False
2025-08-07 18:02:34,238 - src.models.lstm_predictor - INFO - Training Config: {'batch_size': 32, 'epochs': 200, 'patience': 25, 'workers': 1, 'use_multiprocessing': False, 'max_queue_size': 5}
2025-08-07 18:02:34,299 - src.models.lstm_predictor - INFO - Adding ENHANCED temporally accurate sentiment features...
2025-08-07 18:02:34,299 - src.models.lstm_predictor - INFO - Using 5y sentiment with 20 temporal periods
2025-08-07 18:02:34,299 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 1825 days (5y)
2025-08-07 18:02:34,299 - src.analysis.sentiment - INFO - Using historical price-based sentiment for 5y period
2025-08-07 18:02:34,439 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 18:02:34,681 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-07 18:02:34,681 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for TSLA
2025-08-07 18:02:34,681 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-07 18:02:34,681 - src.analysis.sentiment - INFO - Trying alternative news sources for TSLA
2025-08-07 18:02:34,933 - src.analysis.sentiment - INFO - yfinance returned 10 news items for TSLA
2025-08-07 18:02:35,052 - src.analysis.sentiment - INFO - Historical sentiment for TSLA: 0.542 (trend: 1.000, momentum: 0.623, confidence: 1.000, news: 10)
2025-08-07 18:02:35,061 - src.models.lstm_predictor - INFO - Added ENHANCED temporal sentiment: periods=20, avg_sentiment=0.536, confidence=1.000, news_count=10
2025-08-07 18:02:35,061 - src.models.lstm_predictor - INFO - Adding comprehensive 5-year earnings features for training period...
2025-08-07 18:02:35,061 - src.models.lstm_predictor - INFO - Requesting 57 earnings periods for 14.3 years of data
2025-08-07 18:02:35,061 - src.analysis.fundamentals - INFO - Fetching 57 earnings periods for TSLA
2025-08-07 18:02:35,384 - src.analysis.fundamentals - INFO - Finnhub: Retrieved 3 earnings events
2025-08-07 18:02:35,389 - src.models.lstm_predictor - INFO - Found 3 earnings events for comprehensive analysis
2025-08-07 18:02:35,418 - src.models.lstm_predictor - INFO - Added comprehensive earnings features: beat_rate=-1.000, avg_surprise=-0.085, volatility=0.000
2025-08-07 18:02:35,445 - src.models.lstm_predictor - INFO - Generated 124 historical features from 3602 data points
2025-08-07 18:02:35,481 - src.analysis.sentiment - INFO - Analyzing sentiment for TSLA over 7 days (7d)
2025-08-07 18:02:35,481 - src.analysis.sentiment - INFO - Fetching news sentiment from Alpha Vantage for TSLA
2025-08-07 18:02:35,636 - src.analysis.sentiment - INFO - Alpha Vantage response keys: ['Information']
2025-08-07 18:02:35,636 - src.analysis.sentiment - WARNING - No 'feed' key in Alpha Vantage response for TSLA
2025-08-07 18:02:35,636 - src.analysis.sentiment - WARNING - Unexpected response structure: {'Information': 'We have detected your API key as TROVSB0QXA6N4OFS and our standard API rate limit is 25 requests per day. Please subscribe to any of the premium plans at https://www.alphavantage.co/premium/ to instantly remove all daily rate limits.'}
2025-08-07 18:02:35,636 - src.analysis.sentiment - INFO - Trying alternative news sources for TSLA
2025-08-07 18:02:35,791 - src.analysis.sentiment - INFO - yfinance returned 10 news items for TSLA
2025-08-07 18:02:38,300 - src.models.ensemble - INFO - Added 5 sentiment features
2025-08-07 18:02:38,301 - src.models.ensemble - INFO - Selected 26 features for ensemble models
2025-08-07 18:02:38,305 - src.models.ensemble - INFO - Training random_forest...
2025-08-07 18:02:38,914 - src.models.ensemble - INFO - random_forest - Test R²: -0.0381
2025-08-07 18:02:38,914 - src.models.ensemble - INFO - Training gradient_boosting...
2025-08-07 18:02:41,780 - src.models.ensemble - INFO - gradient_boosting - Test R²: -0.1429
2025-08-07 18:02:41,780 - src.models.ensemble - INFO - Training linear_regression...
2025-08-07 18:02:41,793 - src.models.ensemble - INFO - linear_regression - Test R²: 0.0017
2025-08-07 18:02:41,881 - src.models.ensemble - INFO - Ensemble models saved to data/models/TSLA/ensemble
2025-08-07 18:02:41,916 - src.models.ensemble - INFO - Ensemble training completed - Test R²: -0.0273
